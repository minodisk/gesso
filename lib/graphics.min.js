(function(){var __hasProp=Object.prototype.hasOwnProperty,__extends=function(a,b){function d(){this.constructor=a}for(var c in b)__hasProp.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a},__bind=function(a,b){return function(){return a.apply(b,arguments)}},__slice=Array.prototype.slice;((function(){if(!this.require){var a={},b={},c=function(f,g){var h=b[f],i=d(g,f),j;if(h)return h;if(!(j=a[i]||a[i=d(i,"./index")]))throw"module '"+f+"' not found";h={id:f,exports:{}};try{return b[f]=h.exports,j(h.exports,function(a){return c(a,e(i))},h),b[f]=h.exports}catch(k){throw delete b[f],k}},d=function(a,b){var c=[],d,e;/^\.\.?(\/|$)/.test(b)?d=[a,b].join("/").split("/"):d=b.split("/");for(var f=0,g=d.length;f<g;f++)e=d[f],e==".."?c.pop():e!="."&&e!=""&&c.push(e);return c.join("/")},e=function(a){return a.split("/").slice(0,-1).join("/")};this.require=function(a){return c(a,"")},this.require.define=function(b){for(var c in b)a[c]=b[c]}}return this.require.define})).call(this)({"3d/core/Camera":function(a,b,c){((function(){var Camera,a,EulerAngles,Matrix,Vector,d,e,f=Object.prototype.hasOwnProperty,g=function(a,b){function d(){this.constructor=a}for(var c in b)f.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};a=b("core/Klass"),EulerAngles=b("3d/geom/EulerAngles"),Matrix=b("3d/geom/Matrix"),Vector=b("3d/geom/Vector"),e=Math.tan,d=Math.atan,c.exports=Camera=function(){function Camera(){this.defineProperty("fov",function(){return this._fov},function(a){this._fov=a,this._zoom=1/e(a/2)}),this.defineProperty("zoom",function(){return this._zoom},function(a){this._zoom=a,this._fov=2*d(1/a)}),this.position=new Vector(0,0,0),this.orientation=new EulerAngles(0,0,0),this.up=new Vector(0,1,0),this.target={position:Vector.ZERO},this.fov=Math.PI/3,this.near=10,this.far=5e3,this._scene=null,this._screenList=[]}return g(Camera,a),Camera.prototype.addScreen=function(a){return a._camera=this,this._screenList.push(a)},Camera.prototype.snap=function(a){},Camera}()})).call(this)},"3d/core/Renderer":function(a,b,c){((function(){var Matrix,a,Renderer,RotationMatrix,Vector;Matrix=b("3d/geom/Matrix"),RotationMatrix=b("3d/geom/RotationMatrix"),Vector=b("3d/geom/Vector"),a=b("geom/Matrix"),c.exports=Renderer=function(){function Renderer(a){this.scene=a}return Renderer.prototype.render=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p;i=new Matrix,k=new Matrix,d=new Matrix,f=new Matrix,o=this.scene._cameraList,p=[];for(m=0,n=o.length;m<n;m++)a=o[m],i.setupView(a),p.push(function(){var m,n,o,p;o=a._screenList,p=[];for(m=0,n=o.length;m<n;m++)e=o[m],e.graphics.clear(),d.setupProjection(a,e),f.setupScreen(e),p.push(function(){var a,m,n,o,p,q;o=this.scene._displayList,q=[];for(a=0,m=o.length;a<m;a++){b=o[a],k.setupLocalToParent(b.position,b.orientation),l=Matrix.multiply(k,i),h=[],p=b.vertices;for(c=0,n=p.length;c<n;c++)g=p[c],g=Matrix.multiply(g,l),j=g.z,g=Matrix.multiply(g,d),g=Vector.divide(g,j),g=Matrix.multiply(g,f),h[c]=g;q.push(b.drawAt(e,h))}return q}.call(this));return p}.call(this));return p},Renderer}()})).call(this)},"3d/core/Scene":function(a,b,c){((function(){var Matrix,Scene;Matrix=b("3d/geom/Matrix"),c.exports=Scene=function(){function Scene(){this._cameraList=[],this._displayList=[]}return Scene.prototype.addCamera=function(a){return a._scene=this,this._cameraList.push(a)},Scene.prototype.addChild=function(a){return a._scene=this,this._displayList.push(a)},Scene.prototype.render=function(){},Scene}()})).call(this)},"3d/core/Screen":function(a,b,c){((function(){var Screen,Shape,a=Object.prototype.hasOwnProperty,d=function(b,c){function e(){this.constructor=b}for(var d in c)a.call(c,d)&&(b[d]=c[d]);return e.prototype=c.prototype,b.prototype=new e,b.__super__=c.prototype,b};Shape=b("display/Shape"),c.exports=Screen=function(){function Screen(){Screen.__super__.constructor.call(this),this.screenWidth=480,this.screenHeight=360,this._camera=null}return d(Screen,Shape),Screen}()})).call(this)},"3d/display/DisplayObject":function(a,b,c){((function(){var DisplayObject,EulerAngles,Klass,Vector,a=Object.prototype.hasOwnProperty,d=function(b,c){function e(){this.constructor=b}for(var d in c)a.call(c,d)&&(b[d]=c[d]);return e.prototype=c.prototype,b.prototype=new e,b.__super__=c.prototype,b};EulerAngles=b("3d/geom/EulerAngles"),Vector=b("3d/geom/Vector"),Klass=b("core/Klass"),c.exports=DisplayObject=function(){function DisplayObject(){this.position=new Vector(0,0,0),this.orientation=new EulerAngles(0,0,0),this.vertices=[],this.color=0}return d(DisplayObject,Klass),DisplayObject.prototype.drawAt=function(a){},DisplayObject}()})).call(this)},"3d/display/Dot":function(a,b,c){((function(){var DisplayObject,Dot,Vector,a=Object.prototype.hasOwnProperty,d=function(b,c){function e(){this.constructor=b}for(var d in c)a.call(c,d)&&(b[d]=c[d]);return e.prototype=c.prototype,b.prototype=new e,b.__super__=c.prototype,b};DisplayObject=b("3d/display/DisplayObject"),Vector=b("3d/geom/Vector"),c.exports=Dot=function(){function Dot(){Dot.__super__.constructor.call(this),this.vertices[0]=new Vector(0,0,0),this.color=0}return d(Dot,DisplayObject),Dot.prototype.drawAt=function(a,b){var c;return c=a.graphics,c.beginFill(this.color),c.drawCircle(b[0].x,b[0].y,1),c.endFill()},Dot}()})).call(this)},"3d/display/Line":function(a,b,c){((function(){var DisplayObject,Line,Matrix,Vector,a=Object.prototype.hasOwnProperty,d=function(b,c){function e(){this.constructor=b}for(var d in c)a.call(c,d)&&(b[d]=c[d]);return e.prototype=c.prototype,b.prototype=new e,b.__super__=c.prototype,b};DisplayObject=b("3d/display/DisplayObject"),Matrix=b("3d/geom/Matrix"),Vector=b("3d/geom/Vector"),c.exports=Line=function(){function Line(){Line.__super__.constructor.call(this)}return d(Line,DisplayObject),Line.prototype.setupDirection=function(a,b){return this.vertices[0]=a,this.vertices[1]=b},Line.prototype.drawAt=function(a,b){var c;return c=a.graphics,c.lineStyle(1,this.color),c.moveTo(b[0].x,b[0].y),c.lineTo(b[1].x,b[1].y)},Line}()})).call(this)},"3d/display/Plane":function(a,b,c){},"3d/display/Sphere":function(a,b,c){((function(){var DisplayObject,MathUtil,a,d,e,Sphere,Vector,f=Object.prototype.hasOwnProperty,g=function(a,b){function d(){this.constructor=a}for(var c in b)f.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};DisplayObject=b("3d/display/DisplayObject"),Vector=b("3d/geom/Vector"),MathUtil=b("utils/MathUtil"),a=MathUtil.PI,e=MathUtil.PI_2,d=MathUtil.PI2,c.exports=Sphere=function(){function Sphere(a,b,c){a==null&&(a=100),b==null&&(b=8),c==null&&(c=6),Sphere.__super__.constructor.call(this),this._radius=a,this._lngSeg=b,this._latSeg=c,this._updateVertices(),this.defineProperty("radius",function(){return this._radius},function(a){this._radius=a,this._updateVertices()})}return g(Sphere,DisplayObject),Sphere.prototype._updateVertices=function(){var b,c,f,g,h,i,j,k,l,m,n,o;this.vertices=[],i=d/this._lngSeg,f=a/this._latSeg,o=[];for(b=0,n=this._latSeg;b<=n;b+=1)c=f*b-e,j=this._radius*Math.cos(c),l=this._radius*Math.sin(c),o.push(function(){var a,b;b=[];for(g=0,a=this._lngSeg;g<a;g+=1)h=i*g,k=j*Math.cos(h),m=j*Math.sin(h),b.push(this.vertices.push(new Vector(k,l,m)));return b}.call(this));return o},Sphere.prototype.drawAt=function(a,b){var c,d,e,f,g;c=a.graphics,c.lineStyle(0,16777215,0),c.beginFill(16777215),g=[];for(d=0,f=b.length;d<f;d++)e=b[d],g.push(c.drawRect(e.x-1>>0,e.y-1>>0,1,1));return g},Sphere}()})).call(this)},"3d/geom/AABB":function(a,b,c){((function(){var AABB,a,d,e,f,Vector;Vector=b("3d/geom/Vector"),a=Number.MAX_VALUE,e=-a,f=new Vector(e,e,e),d=new Vector(a,a,a),c.exports=AABB=function(){function AABB(){var a;if(this instanceof AABB)(a=arguments[0])instanceof AABB?(this.min=new Vector(a.min),this.max=new Vector(a.max)):(this.min=new Vector(f),this.max=new Vector(d));else return new AABB}return AABB.intersectAABBs=function(a,b,c){return a.min.x>b.max.x||a.max.x<b.min.x||a.min.y>b.max.y||a.max.y<b.min.y||a.min.z>b.max.z||a.max.z<b.min.z?!1:(c!=null&&(c.min.x=max(a.min.x,b.min.x),c.max.x=min(a.max.x,b.max.x),c.min.y=max(a.min.y,b.min.y),c.max.y=min(a.max.y,b.max.y),c.min.z=max(a.min.z,b.min.z),c.max.z=min(a.max.z,b.max.z)),!0)},AABB.intersectMovingAABB=function(b,c,d){var e,f,g,h,i,j,k,l,m;f=0,g=1;if(d.x===0){if(b.min.x>=c.max.x||b.max.x<=c.min.x)return a}else{e=1/d.x,h=(b.min.x-c.max.x)*e,i=(b.max.x-c.min.x)*e,h>i&&swap(h,i),h>f&&(f=h),i<g&&(g=i);if(f>g)return a}if(d.y===0){if(b.min.y>=c.max.y||b.max.y<=c.min.y)return a}else{e=1/d.y,j=(b.min.y-c.max.y)*e,k=(b.max.y-c.min.y)*e,j>k&&swap(j,k),j>f&&(f=j),k<g&&(g=k);if(f>g)return a}if(d.z===0){if(b.min.z>=c.max.z||b.max.z<=c.min.z)return a}else{e=1/d.z,l=(b.min.z-c.max.z)*e,m=(b.max.z-c.min.z)*e,l>m&&swap(l,m),l>f&&(f=l),m<g&&(g=m);if(f>g)return a}return f},AABB.prototype.size=function(){return this.max.subtract(this.min)},AABB.prototype.xSize=function(){return this.max.x-this.min.x},AABB.prototype.ySize=function(){return this.max.y-this.min.y},AABB.prototype.zSize=function(){return this.max.z-this.min.z},AABB.prototype.center=function(){return this.min.add(max).multiply(.5)},AABB.prototype.corner=function(a){if(a<0||7<a)throw new TypeError("'i' must be specified between 0 and 7.");return new Vector(a&1?this.max.x:this.min.x,a&2?this.max.y:this.min.y,a&4?this.max.z:this.min.z)},AABB.prototype.empty=function(){this.min.x=this.min.y=this.min.z=a,this.max.x=this.max.y=this.max.z=e},AABB.prototype.add=function(a){var b;if(a instanceof AABB){b=a,this.add(b.min),this.add(b.max);return}a.x<this.min.x&&(this.min.x=a.x),a.x>this.max.x&&(this.max.x=a.x),a.y<this.min.y&&(this.min.y=a.y),a.y>this.max.y&&(this.max.y=a.y),a.z<this.min.z&&(this.min.z=a.z),a.z>this.max.z&&(this.max.z=a.z)},AABB.prototype.setTransformedBox=function(a,b){if(a.isEmpty()){this.empty();return}this.min=this.max=getTranslation(b),b.m11>0?(this.min.x+=b.m11*a.min.x,this.max.x+=b.m11*a.max.x):(this.min.x+=b.m11*a.max.x,this.max.x+=b.m11*a.min.x),b.m12>0?(this.min.y+=b.m12*a.min.x,this.max.y+=b.m12*a.max.x):(this.min.y+=b.m12*a.max.x,this.max.y+=b.m12*a.min.x),b.m13>0?(this.min.z+=b.m13*a.min.x,this.max.z+=b.m13*a.max.x):(this.min.z+=b.m13*a.max.x,this.max.z+=b.m13*a.min.x),b.m21>0?(this.min.x+=b.m21*a.min.y,this.max.x+=b.m21*a.max.y):(this.min.x+=b.m21*a.max.y,this.max.x+=b.m21*a.min.y),b.m22>0?(this.min.y+=b.m22*a.min.y,this.max.y+=b.m22*a.max.y):(this.min.y+=b.m22*a.max.y,this.max.y+=b.m22*a.min.y),b.m23>0?(this.min.z+=b.m23*a.min.y,this.max.z+=b.m23*a.max.y):(this.min.z+=b.m23*a.max.y,this.max.z+=b.m23*a.min.y),b.m31>0?(this.min.x+=b.m31*a.min.z,this.max.x+=b.m31*a.max.z):(this.min.x+=b.m31*a.max.z,this.max.x+=b.m31*a.min.z),b.m32>0?(this.min.y+=b.m32*a.min.z,this.max.y+=b.m32*a.max.z):(this.min.y+=b.m32*a.max.z,this.max.y+=b.m32*a.min.z),b.m33>0?(this.min.z+=b.m33*a.min.z,this.max.z+=b.m33*a.max.z):(this.min.z+=b.m33*a.max.z,this.max.z+=b.m33*a.min.z)},AABB.prototype.isEmpty=function(){return this.min.x>this.max.x||this.min.y>this.max.y||this.min.z>this.max.z},AABB.prototype.contains=function(a){return a.x>=this.min.x&&a.x<=this.max.x&&a.y>=this.min.y&&a.y<=this.max.y&&a.z>=this.min.z&&a.z<=this.max.z},AABB.prototype.closestPointTo=function(a){return new Vector((a.x<this.min.x?this.min.x:a.x>this.max.x?this.max.x:a.x,a.y<this.min.y?this.min.y:a.y>this.max.y?this.max.y:a.y,a.z<this.min.z?this.min.z:a.z>this.max.z?this.max.z:a.z))},AABB.prototype.intersectsSphere=function(a,b){var c;return c=closestPointTo(a),Vector.distanceSquared(a,c)<b*b},AABB.prototype.rayIntersect=function(b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p;e=!0;if(b.x<this.min.x){j=this.min.x-b.x;if(j>c.x)return a;j/=c.x,e=!1,i=-1}else if(b.x>this.max.x){j=this.max.x-b.x;if(j<c.x)return a;j/=c.x,e=!1,i=1}else j=-1;if(b.y<this.min.y){m=this.min.y-b.y;if(m>c.y)return a;m/=c.y,e=!1,l=-1}else if(b.y>this.max.y){m=this.max.y-b.y;if(m<c.y)return a;m/=c.y,e=!1,l=1}else m=-1;if(b.z<this.min.z){p=this.min.z-b.z;if(p>c.z)return a;p/=c.z,e=!1,o=-1}else if(b.z>this.max.z){p=this.max.z-b.z;if(p<c.z)return a;p/=c.z,e=!1,o=1}else p=-1;if(e)return d!=null&&(d=-c,d.normalize()),0;g=0,f=j,m>f&&(g=1,f=m),p>f&&(g=2,f=p);switch(g){case 0:float(k=b.y+c.y*f);if(k<this.min.y||k>this.max.y)return a;float(n=b.z+c.z*f);if(n<this.min.z||n>this.max.z)return a;d!=null&&(d.x=i,d.y=0,d.z=0);break;case 1:float(h=b.x+c.x*f);if(h<this.min.x||h>this.max.x)return a;float(n=b.z+c.z*f);if(n<this.min.z||n>this.max.z)return a;d!=null&&(d.x=0,d.y=l,d.z=0);break;case 2:float(h=b.x+c.x*f);if(h<this.min.x||h>this.max.x)return a;float(k=b.y+c.y*f);if(k<this.min.y||k>this.max.y)return a;d!=null&&(d.x=0,d.y=0,d.z=o)}return f},AABB.prototype.classifyPlane=function(a,b){var c,d;return a.x>0?(d=a.x*this.min.x,c=a.x*this.max.x):(d=a.x*this.max.x,c=a.x*this.min.x),a.y>0?(d+=a.y*this.min.y,c+=a.y*this.max.y):(d+=a.y*this.max.y,c+=a.y*this.min.y),a.z>0?(d+=a.z*this.min.z,c+=a.z*this.max.z):(d+=a.z*this.max.z,c+=a.z*this.min.z),d>=b?1:c<=b?-1:0},AABB.prototype.intersectPlane=function(b,c,d){var e,f,g,h;if(abs(Vector.magnitudeSquared(b)-1)<.01){if(abs(Vector.magnitudeSquared(d)-1)<.01)return e=Vector.innerProduct(b,d),e>=0?a:(b.x>0?(g=b.x*this.min.x,f=b.x*this.max.x):(g=b.x*this.max.x,f=b.x*this.min.x),b.y>0?(g+=b.y*this.min.y,f+=b.y*this.max.y):(g+=b.y*this.max.y,f+=b.y*this.min.y),b.z>0?(g+=b.z*this.min.z,f+=b.z*this.max.z):(g+=b.z*this.max.z,f+=b.z*this.min.z),f<=c?a:(h=c-g/e,h<0?0:h));throw new TypeError("'dir' must specified Vector.")}throw new TypeError("'n' must specified Vector.")},AABB}()})).call(this)},"3d/geom/EulerAngles":function(a,b,c){((function(){var EulerAngles,MathUtil,a,d,e,f,g,h,i,j,k,l,m;MathUtil=b("utils/MathUtil"),a=MathUtil.PI,d=MathUtil.PI2,e=MathUtil.PI_2,l=MathUtil._PI,m=MathUtil._PI2,f=Math.abs,j=Math.sin,i=Math.cos,g=Math.asin,h=Math.atan2,k=MathUtil.wrapPi,c.exports=EulerAngles=function(){function EulerAngles(a,b,c){var d;if(this instanceof EulerAngles)(d=arguments[0])instanceof EulerAngles?(this.heading=d.heading,this.pitch=d.pitch,this.bank=d.bank):(this.heading=a,this.pitch=b,this.bank=c);else return new EulerAngles(a,b,c)}return EulerAngles.IDENTITY=new EulerAngles(0,0,0),EulerAngles.prototype.identity=function(){return this.heading=this.pitch=this.bank=0},EulerAngles.prototype.canonize=function(){this.pitch=k(this.pitch),this.pitch<-e?(this.pitch=-a-this.pitch,this.heading+=a,this.bank+=a):this.pitch>e&&(this.pitch=a-this.pitch,this.heading+=a,this.bank+=a),f(this.pitch)>e-1e-4?(this.heading+=this.bank,this.bank=0):this.bank=k(this.bank),this.heading=k(this.heading)},EulerAngles.prototype.fromObjectToInertialQuaternion=function(a){var b;b=2*(a.y*a.z-a.w*a.x),f(b)>.9999?(this.pitch=e*b,this.heading=h(-a.x*a.z+a.w*a.y,.5-a.y*a.y-a.z*a.z),this.bank=0):(this.pitch=g(b),this.heading=h(a.x*a.z+a.w*a.y,.5-a.x*a.x-a.y*a.y),this.bank=h(a.x*a.y+a.w*a.z,.5-a.x*a.x-a.z*a.z))},EulerAngles.prototype.fromInertialToObjectQuaternion=function(a){var b;b=-2*(a.y*a.z+a.w*a.x),f(b)>.9999?(this.pitch=e*b,this.heading=h(-a.x*a.z-a.w*a.y,.5-a.y*a.y-a.z*a.z),this.bank=0):(this.pitch=g(b),this.heading=h(a.x*a.z-a.w*a.y,.5-a.x*a.x-a.y*a.y),this.bank=h(a.x*a.y-a.w*a.z,.5-a.x*a.x-a.z*a.z))},EulerAngles.prototype.fromObjectToWorldMatrix=function(a){var b;b=-a.m32,f(b)>9.99999?(this.pitch=e*b,this.heading=h(-a.m23,a.m11),this.bank=0):(this.heading=h(a.m31,a.m33),this.pitch=g(b),this.bank=h(a.m12,a.m22))},EulerAngles.prototype.fromWorldToObjectMatrix=function(a){var b;b=-a.m23,f(b)>9.99999?(this.pitch=e*b,this.heading=h(-a.m31,a.m11),this.bank=0):(this.heading=h(a.m13,a.m33),this.pitch=g(b),this.bank=h(a.m21,a.m22))},EulerAngles.prototype.fromRotationMatrix=function(a){var b;b=-a.m23,f(b)>9.99999?(this.pitch=e*b,this.heading=h(-a.m31,a.m11),this.bank=0):(this.heading=h(a.m13,a.m33),this.pitch=g(b),this.bank=h(a.m21,a.m22))},EulerAngles}()})).call(this)},"3d/geom/Matrix":function(a,b,c){((function(){var EulerAngles,Matrix,Quaternion,RotationMatrix,Vector,a,d,e,f;EulerAngles=b("3d/geom/EulerAngles"),RotationMatrix=b("3d/geom/RotationMatrix"),Quaternion=b("3d/geom/Quaternion"),Vector=b("3d/geom/Vector"),a=Math.abs,e=Math.sin,d=Math.cos,f=Math.tan,c.exports=Matrix=function(){function Matrix(a,b,c,d,e,f,g,h,i,j,k,l){var m;if(this instanceof Matrix)(m=arguments[0])instanceof Matrix?(this.m11=m.m11,this.m12=m.m12,this.m13=m.m13,this.m21=m.m21,this.m22=m.m22,this.m23=m.m23,this.m31=m.m31,this.m32=m.m32,this.m33=m.m33,this.tx=m.tx,this.ty=m.ty,this.tz=m.tz):(this.m11=a,this.m12=b,this.m13=c,this.m21=d,this.m22=e,this.m23=f,this.m31=g,this.m32=h,this.m33=i,this.tx=j,this.ty=k,this.tz=l);else return new Matrix(a,b,c,d,e,f,g,h,i,j,k,l)}return Matrix.IDENTITY=new Matrix(1,0,0,0,1,0,0,0,1,0,0,0),Matrix.multiply=function(a,b){if(b instanceof Matrix){if(a instanceof Vector)return new Vector(a.x*b.m11+a.y*b.m21+a.z*b.m31+b.tx,a.x*b.m12+a.y*b.m22+a.z*b.m32+b.ty,a.x*b.m13+a.y*b.m23+a.z*b.m33+b.tz);if(a instanceof Matrix)return new Matrix(a.m11*b.m11+a.m12*b.m21+a.m13*b.m31,a.m11*b.m12+a.m12*b.m22+a.m13*b.m32,a.m11*b.m13+a.m12*b.m23+a.m13*b.m33,a.m21*b.m11+a.m22*b.m21+a.m23*b.m31,a.m21*b.m12+a.m22*b.m22+a.m23*b.m32,a.m21*b.m13+a.m22*b.m23+a.m23*b.m33,a.m31*b.m11+a.m32*b.m21+a.m33*b.m31,a.m31*b.m12+a.m32*b.m22+a.m33*b.m32,a.m31*b.m13+a.m32*b.m23+a.m33*b.m33,a.tx*b.m11+a.ty*b.m21+a.tz*b.m31+b.tx,a.tx*b.m12+a.ty*b.m22+a.tz*b.m32+b.ty,a.tx*b.m13+a.ty*b.m23+a.tz*b.m33+b.tz);throw new TypeError("'a' must be specified an instance of Vector or Matrix.")}throw new TypeError("'b' must be specified an instance of Matrix.")},Matrix.determinant=function(a){return a.m11*(a.m22*a.m33-a.m23*a.m32)+a.m12*(a.m23*a.m31-a.m21*a.m33)+a.m13*(a.m21*a.m32-a.m22*a.m31)},Matrix.invert=function(b){var c,d;c=this.determinant(b);if(a(c)>1e-6)return d=1/c,new Matrix((b.m22*b.m33-b.m23*b.m32)*d,(b.m13*b.m32-b.m12*b.m33)*d,(b.m12*b.m23-b.m13*b.m22)*d,(b.m23*b.m31-b.m21*b.m33)*d,(b.m11*b.m33-b.m13*b.m31)*d,(b.m13*b.m21-b.m11*b.m23)*d,(b.m21*b.m32-b.m22*b.m31)*d,(b.m12*b.m31-b.m11*b.m32)*d,(b.m11*b.m22-b.m12*b.m21)*d,-(b.tx*r.m11+b.ty*r.m21+b.tz*r.m31),-(b.tx*r.m12+b.ty*r.m22+b.tz*r.m32),-(b.tx*r.m13+b.ty*r.m23+b.tz*r.m33));throw new TypeError("Zero matrix doesn't have inverse matrix.")},Matrix.prototype.setupView=function(a){var b,c,d;d=Vector.subtract(a.target.position,a.position),d.normalize(),b=Vector.crossProduct(a.up,d),b.normalize(),c=Vector.crossProduct(d,b),this.m11=b.x,this.m12=c.x,this.m13=d.x,this.m21=b.y,this.m22=c.y,this.m23=d.y,this.m31=b.z,this.m32=c.z,this.m33=d.z,this.tx=-Vector.dotProduct(a.position,b),this.ty=-Vector.dotProduct(a.position,c),this.tz=-Vector.dotProduct(a.position,d)},Matrix.prototype.setupProjection=function(a,b){var c,d,e;d=1/f(a.fov/2),c=d*b.screenHeight/b.screenWidth,e=a.far/(a.far-a.near),this.m11=c,this.m12=0,this.m13=0,this.m21=0,this.m22=d,this.m23=0,this.m31=0,this.m32=0,this.m33=e,this.tx=0,this.ty=0,this.tz=-e*a.near},Matrix.prototype.setupScreen=function(a){var b,c;return c=a.screenWidth/2,b=a.screenHeight/2,this.m11=c,this.m12=0,this.m13=0,this.m21=0,this.m22=-b,this.m23=0,this.m31=0,this.m32=0,this.m33=1,this.tx=c,this.ty=b,this.tz=0},Matrix.prototype.identity=function(){this.m11=1,this.m12=0,this.m13=0,this.m21=0,this.m22=1,this.m23=0,this.m31=0,this.m32=0,this.m33=1,this.tx=0,this.ty=0,this.tz=0},Matrix.prototype.zeroTranslation=function(){this.tx=this.ty=this.tz=0},Matrix.prototype.setTranslation=function(a){this.tx=a.x,this.ty=a.y,this.tz=a.z},Matrix.prototype.setupTranslation=function(a){this.m11=1,this.m12=0,this.m13=0,this.m21=0,this.m22=1,this.m23=0,this.m31=0,this.m32=0,this.m33=1,this.tx=a.x,this.ty=a.y,this.tz=a.z},Matrix.prototype.setupLocalToParent=function(a,b){var c;b instanceof EulerAngles&&(c=new RotationMatrix,c.setup(b),b=c),this.m11=b.m11,this.m12=b.m21,this.m13=b.m31,this.m21=b.m12,this.m22=b.m22,this.m23=b.m32,this.m31=b.m13,this.m32=b.m23,this.m33=b.m33,this.tx=a.x,this.ty=a.y,this.tz=a.z},Matrix.prototype.setupParentToLocal=function(a,b){var c;b instanceof EulerAngles&&(c=new RotationMatrix,c.setup(b),b=c),this.m11=b.m11,this.m12=b.m12,this.m13=b.m13,this.m21=b.m21,this.m22=b.m22,this.m23=b.m23,this.m31=b.m31,this.m32=b.m32,this.m33=b.m33,this.tx=-(a.x*this.m11+a.y*this.m21+a.z*this.m31),this.ty=-(a.x*this.m12+a.y*this.m22+a.z*this.m32),this.tz=-(a.x*this.m13+a.y*this.m23+a.z*this.m33)},Matrix.prototype.setupRotate=function(a,b){var c,f,g,h,i,j;j=e(b),i=d(b);if(a instanceof Vector)c=1-i,f=c*a.x,g=c*a.y,h=c*a.z,this.m11=f*a.x+i,this.m12=f*a.y+a.z*j,this.m13=f*a.z-a.y*j,this.m21=g*a.x-a.z*j,this.m22=g*a.y+i,this.m23=g*a.z+a.x*j,this.m31=h*a.x+a.y*j,this.m32=h*a.y-a.x*j,this.m33=h*a.z+i;else switch(a){case 1:this.m11=1,this.m12=0,this.m13=0,this.m21=0,this.m22=i,this.m23=j,this.m31=0,this.m32=-j,this.m33=i;break;case 2:this.m11=i,this.m12=0,this.m13=-j,this.m21=0,this.m22=1,this.m23=0,this.m31=j,this.m32=0,this.m33=i;break;case 3:this.m11=i,this.m12=j,this.m13=0,this.m21=-j,this.m22=i,this.m23=0,this.m31=0,this.m32=0,this.m33=1;break;default:throw new Error("'axis' must be specified 1, 2 or 3.")}this.tx=this.ty=this.tz=0},Matrix.prototype.fromQuaternion=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n;b=2*a.w,f=2*a.x,j=2*a.y,m=2*a.z,c=b*a.x,d=b*a.y,e=b*a.z,g=f*a.x,h=f*a.y,i=f*a.z,k=j*a.y,l=j*a.z,n=j*a.z,this.m11=1-k-n,this.m12=h+e,this.m13=i-d,this.m21=h-e,this.m22=1-g-n,this.m23=l+c,this.m31=i+d,this.m32=l-c,this.m33=1-g-k,this.tx=this.ty=this.tz=0},Matrix.prototype.setupScale=function(a){this.m11=s.x,this.m12=0,this.m13=0,this.m21=0,this.m22=s.y,this.m23=0,this.m31=0,this.m32=0,this.m33=s.z,this.tx=this.ty=this.tz=0},Matrix.prototype.setupScaleAlongAxis=function(b,c){var d,e,f,g;if(a(Vector.magnitudeSquared(b)-1)<.01)d=k-1,e=d*b.x,f=d*b.y,g=d*b.z,this.m11=e*b.x+1,this.m22=f*b.y+1,this.m33=g*b.z+1,this.m21=this.m21=e*b.y,this.m13=this.m31=e*b.z,this.m23=this.m32=f*b.z,this.tx=this.ty=this.tz=0;else throw new TypeError("'axis' must be specified a unit vector.")},Matrix.prototype.setupShear=function(a,b,c){switch(a){case 1:this.m11=1,this.m12=b,this.m13=c,this.m21=0,this.m22=1,this.m23=0,this.m31=0,this.m32=0,this.m33=1;break;case 2:this.m11=1,this.m12=0,this.m13=0,this.m21=b,this.m22=1,this.m23=c,this.m31=0,this.m32=0,this.m33=1;break;case 3:this.m11=1,this.m12=0,this.m13=0,this.m21=0,this.m22=1,this.m23=0,this.m31=b,this.m32=c,this.m33=1;break;default:throw new TypeError("axis must be specified 1, 2 or 3.")}this.tx=this.ty=this.tz=0},Matrix.prototype.setupProject=function(b){if(a(Vector.magnitudeSquared(b)-1)<.1)this.m11=1-b.x*b.x,this.m22=1-b.y*b.y,this.m33=1-b.z*b.z,this.m12=this.m21=-b.x*b.y,this.m13=this.m31=-b.x*b.z,this.m23=this.m32=-b.y*b.z,this.tx=this.ty=this.tz=0;else throw new TypeError("'n' must be specified a unit vector.")},Matrix.prototype.setupReflect=function(a,b){var c,d,e,f;b==null&&(b=0);if(a instanceof Vector){f=a;if(abss(Vector.magnitudeSquared(f)-1)<.01)c=-2*f.x,d=-2*f.y,e=-2*f.z,this.m11=1+c*f.x,this.m22=1+d*f.y,this.m33=1+e*f.z,this.m12=this.m21=c*f.y,this.m13=this.m31=c*f.z,this.m23=this.m32=d*f.z,this.tx=this.ty=this.tz=0;else throw new TypeError("'n' must be specified a unit vector.")}else switch(a){case 1:this.m11=-1,this.m12=0,this.m13=0,this.m21=0,this.m22=1,this.m23=0,this.m31=0,this.m32=0,this.m33=1,this.tx=2*b,this.ty=0,this.tz=0;break;case 2:this.m11=1,this.m12=0,this.m13=0,this.m21=0,this.m22=-1,this.m23=0,this.m31=0,this.m32=0,this.m33=1,this.tx=0,this.ty=2*b,this.tz=0;break;case 2:this.m11=1,this.m12=0,this.m13=0,this.m21=0,this.m22=1,this.m23=0,this.m31=0,this.m32=0,this.m33=-1,this.tx=0,this.ty=0,this.tz=2*b;break;default:throw new TypeError("'axis' must be specified 1, 2 or 3.")}},Matrix.prototype.getTranslation=function(a){return new Vector(a.tx,a.ty,a.tz)},Matrix.prototype.getPositionFromParentToLocalMatrix=function(a){return new Vector(-(a.tx*a.m11+a.ty*a.m12+a.tz*a.m13),-(a.tx*a.m21+a.ty*a.m22+a.tz*a.m23),-(a.tx*a.m31+a.ty*a.m32+a.tz*a.m33))},Matrix.prototype.getPositionFromLocalToParentMatrix=function(a){return new Vector(a.tx,a.ty,a.tz)},Matrix}()})).call(this)},"3d/geom/Quaternion":function(a,b,c){((function(){var MathUtil,Quaternion,Vector,a,d,e,f,g;Vector=b("3d/geom/Vector"),MathUtil=b("utils/MathUtil"),a=Math.abs,g=Math.sqrt,f=Math.sin,d=Math.cos,e=MathUtil.safeAcos,c.exports=Quaternion=function(){function Quaternion(a,b,c,d){var e;if(this instanceof Quaternion)(e=arguments[0])instanceof Quaternion?(this.w=e.w,this.x=e.x,this.y=e.y,this.z=e.z):(this.w=a,this.x=b,this.y=c,this.z=d);else return new Quaternion(a,b,c,d)}return Quaternion.IDENTITY=new Quaternion(1,0,0,0),Quaternion.dotProduct=function(a,b){return a.w*b.w+a.x*b.y+a.y*b.y+a.z*b.z},Quaternion.slerp=function(a,b,c){var d,e,h,i,j,k,l,m,n,o;if(c<=0)return a;if(c>=1)return b;d=this.dotProduct(a,b),k=s1.w,l=s1.x,m=s1.y,n=s1.z,d<0&&(k*=-1,l*=-1,m*=-1,n*=-1,d*=-1);if(d<1.1)return d>.9999?(e=1-c,h=c):(o=g(1-d*d),i=atan2(o,d),j=1/o,e=f((1-c)*i)*j,h=f(c*i)*j),new Quaternion(e*a.x+h*l,e*a.y+h*m,e*a.z+h*n,e*a.w+h*k);throw new Error("")},Quaternion.conjugate=function(a){return new Quaternion(a.w,-a.x,-a.y,-a.z)},Quaternion.pow=function(b,c){var e,g,h;return a(b.w)>.9999?b:(e=acos(b.w),h=e*c,g=f(h)/f(e),new Quaternion(d(h),b.x*g,b.y*g,b.z*g))},Quaternion.prototype.identity=function(){return this.w=1,this.x=this.y=this.z=0},Quaternion.prototype.setToRotateAboutX=function(a){var b;return b=a/2,this.w=d(b),this.x=f(b),this.y=0,this.z=0},Quaternion.prototype.setToRotateAboutY=function(a){var b;return b=a/2,this.w=d(b),this.x=0,this.y=f(b),this.z=0},Quaternion.prototype.setToRotateAboutZ=function(a){var b;return b=a/2,this.w=d(b),this.x=0,this.y=f(b),this.z=0},Quaternion.prototype.setToRotateAboutAxis=function(b,c){var d,e;if(a(Vector.magnitude(b)-1)<.01)return e=c/2,d=f(e),this.w=con(e),this.x=b.x*d,this.y=b.y*d,this.z=b.z*d;throw new Error("'axis' should be normalized.")},Quaternion.prototype.setToRotateObjectToInertial=function(a){var b,c,e,g,h,i,j,k,l;return h=a.heading/2,i=a.pitch/2,b=a.bank/2,k=f(h),e=d(h),l=f(i),g=d(i),j=f(b),c=d(b),this.w=e*g*c+k*l*j,this.x=e*l*c+k*g*j,this.y=-e*l*j+k*g*c,this.z=-k*l*c+e*g*j},Quaternion.prototype.setToRotateInertialToObject=function(a){var b,c,e,g,h,i,j,k,l;return h=a.heading/2,i=a.pitch/2,b=a.bank/2,k=f(h),e=d(h),l=f(i),g=d(i),j=f(b),c=d(b),this.w=e*g*c+k*l*j,this.x=-e*l*c-k*g*j,this.y=e*l*j-k*g*c,this.z=k*l*c-e*g*j},Quaternion.prototype.crossProduct=function(a){return new Quaternion(this.w*a.w-this.x*a.x-this.y*a.y-this.z*a.z,this.w*a.x+this.x*a.w+this.z*a.y-this.y*a.z,this.w*a.y+this.y*a.w+this.x*a.z-this.z*a.x,this.w*a.z+this.z*a.w+this.y*a.x-this.x*a.y)},Quaternion.prototype.normalize=function(){var a,b;a=g(this.w*this.w+this.x*this.x+this.y*this.y+this.z*this.z);if(a>0)return b=1/a,this.w+=b,this.x+=b,this.y+=b,this.z+=b;throw new Error("Zero magnitude")},Quaternion.prototype.getRotationAngle=function(){var a;return a=e(this.w),a*2},Quaternion.prototype.getRotationAxis=function(){var a,b;return b=1-this.w*this.w,b<=0?new Vector(1,0,0):(a=1/g(b),new Vector(this.x*a,this.y*a,this.z*a))},Quaternion}()})).call(this)},"3d/geom/RotationMatrix":function(a,b,c){((function(){var RotationMatrix,Vector,a,d;Vector=b("3d/geom/Vector"),d=Math.sin,a=Math.cos,c.exports=RotationMatrix=function(){function RotationMatrix(a,b,c,d,e,f,g,h,i){var j;if(this instanceof RotationMatrix)(j=arguments[0])instanceof RotationMatrix?(this.m11=j.m11,this.m12=j.m12,this.m13=j.m13,this.m21=j.m21,this.m22=j.m22,this.m23=j.m23,this.m31=j.m31,this.m32=j.m32,this.m33=j.m33):(this.m11=a,this.m12=b,this.m13=c,this.m21=d,this.m22=e,this.m23=f,this.m31=g,this.m32=h,this.m33=i);else return new RotationMatrix(a,b,c,d,e,f,g,h,i)}return RotationMatrix.prototype.identity=function(){this.m11=1,this.m12=0,this.m13=0,this.m21=0,this.m22=1,this.m23=0,this.m31=0,this.m32=0,this.m33=1},RotationMatrix.prototype.setup=function(b){var c,e,f,g,h,i;h=d(b.heading),e=a(b.heading),i=d(b.pitch),f=a(b.pitch),g=d(b.bank),c=a(b.bank),this.m11=e*c+h*i*g,this.m12=-e*g+h*i*c,this.m13=h*f,this.m21=g*f,this.m22=c*f,this.m23=-i,this.m31=-h*c+e*i*g,this.m32=g*h+e*i*c,this.m33=e*f},RotationMatrix.prototype.fromInertialToObjectQuaternion=function(a){var b,c,d,e,f,g,h,i,j;b=a.w*a.x,c=a.w*a.y,d=a.w*a.z,e=a.x*a.x,f=a.x*a.y,g=a.x*a.z,h=a.y*a.y,i=a.y*a.z,j=a.z*a.z,this.m11=1-2*(h+j),this.m12=2*(f+d),this.m13=2*(g-c),this.m21=2*(f-d),this.m22=1-2*(e+j),this.m23=2*(i+b),this.m31=2*(g+c),this.m32=2*(i-b),this.m33=1-2*(e+h)},RotationMatrix.prototype.fromObjectToInertialQuaternion=function(a){var b,c,d,e,f,g,h,i,j;b=a.w*a.x,c=a.w*a.y,d=a.w*a.z,e=a.x*a.x,f=a.x*a.y,g=a.x*a.z,h=a.y*a.y,i=a.y*a.z,j=a.z*a.z,this.m11=1-2*(h+j),this.m12=2*(f-d),this.m13=2*(g+c),this.m21=2*(f+d),this.m22=1-2*(e+j),this.m23=2*(i-b),this.m31=2*(g-c),this.m32=2*(i+b),this.m33=1-2*(e+h)},RotationMatrix.prototype.inertialToObject=function(a){return new Vector(this.m11*a.x+this.m21*a.y+this.m31*a.z,this.m12*a.x+this.m22*a.y+this.m32*a.z,this.m13*a.x+this.m23*a.y+this.m33*a.z)},RotationMatrix.prototype.objectToInertial=function(a){return new Vector(this.m11*a.x+this.m12*a.y+this.m13*a.z,this.m21*a.x+this.m22*a.y+this.m23*a.z,this.m31*a.x+this.m32*a.y+this.m33*a.z)},RotationMatrix}()})).call(this)},"3d/geom/Vector":function(a,b,c){((function(){var Vector,a;a=Math.sqrt,c.exports=Vector=function(){function Vector(a,b,c){var d;if(this instanceof Vector)(d=arguments[0])instanceof Vector?(this.x=d.x,this.y=d.y,this.z=d.z):(this.x=a,this.y=b,this.z=c);else return new Vector(a,b,c)}return Vector.ZERO=new Vector(0,0,0),Vector.equals=function(a,b){return a.x===b.x&&a.y===b.y&&a.z===b.z},Vector.notEquals=function(a,b){return a.x!==b.x||a.y!==b.y||a.z!==b.z},Vector.add=function(a,b){return new Vector(a.x+b.x,a.y+b.y,a.z+b.z)},Vector.subtract=function(a,b){return new Vector(a.x-b.x,a.y-b.y,a.z-b.z)},Vector.multiply=function(a,b){return new Vector(a.x*b,a.y*b,a.z*b)},Vector.divide=function(a,b){return new Vector(a.x/b,a.y/b,a.z/b)},Vector.dotProduct=function(a,b){return a.x*b.x+a.y*b.y+a.z*b.z},Vector.crossProduct=function(a,b){return new Vector(a.y*b.z-a.z*b.y,a.z*b.x-a.x*b.z,a.x*b.y-a.y*b.x)},Vector.magnitude=function(b){return a(b.x*b.x+b.y*b.y+b.z*b.z)},Vector.magnitudeSquared=function(a){return a.x*a.x+a.y*a.y+a.z*a.z},Vector.distance=function(b,c){var d,e,f;return d=b.x-c.x,e=b.y-c.y,f=b.z-c.z,a(d*d+e*e+f*f)},Vector.distanceSquared=function(a,b){var c,d,e;return c=a.x-b.x,d=a.y-b.y,e=a.z-b.z,c*c+d*d+e*e},Vector.prototype.apply=function(a){this.x=a.x,this.y=a.y,this.z=a.z},Vector.prototype.zero=function(){this.x=this.y=this.z=0},Vector.prototype.invert=function(){this.a*=-1,this.b*=-1,this.c*=-1},Vector.prototype.normalize=function(){var b,c;c=this.x*this.x+this.y*this.y+this.z*this.z,c>0&&(b=a(c),this.x/=b,this.y/=b,this.z/=b)},Vector}()})).call(this)},"core/Klass":function(a,b,c){((function(){var Klass;c.exports=Klass=function(){function Klass(){}return Klass.prototype.defineProperty=function(){if(Object.defineProperty!=null)return function(a,b,c){var d;return d={},b!=null&&(d.get=b),c!=null&&(d.set=c),d.enumerable=!0,d.configuable=!1,Object.defineProperty(this,a,d)};if(Object.prototype.__defineGetter__!=null&&Object.prototype.__defineSetter__!=null)return function(a,b,c){b!=null&&this.prototype.__defineGetter__(a,b);if(c!=null)return this.prototype.__defineSetter__(a,c)};throw new Error("Doesn't support 'getter/setter' properties.")}(),Klass}()})).call(this)},"display/Bitmap":function(a,b,c){((function(){var Bitmap,DisplayObject,Rectangle,a=Object.prototype.hasOwnProperty,d=function(b,c){function e(){this.constructor=b}for(var d in c)a.call(c,d)&&(b[d]=c[d]);return e.prototype=c.prototype,b.prototype=new e,b.__super__=c.prototype,b};DisplayObject=b("display/DisplayObject"),Rectangle=b("geom/Rectangle"),c.exports=Bitmap=function(){function Bitmap(){Bitmap.__super__.constructor.call(this,"Bitmap")}return d(Bitmap,DisplayObject),Bitmap.prototype.draw=function(a,b,c){b==null&&(b=0),c==null&&(c=0),a instanceof DisplayObject&&(a=a._context.canvas);if(a instanceof Image||a instanceof HTMLImageElement||a instanceof HTMLCanvasElement||a instanceof HTMLVideoElement){this.drawImage(a,b,c);return}if(a instanceof ImageData){this.drawImageData(a,b,c);return}throw new TypeError("data isn't drawable object")},Bitmap.prototype.drawImage=function(a,b,c){return b==null&&(b=0),c==null&&(c=0),this._stacks.push({method:"drawImage",arguments:[a,b,c],rect:new Rectangle(b,c,a.width,a.height)}),this._requestRender(!0)},Bitmap.prototype._drawImage=function(a,b,c){this._context.drawImage(a,b,c,a.width,a.height)},Bitmap.prototype.drawImageData=function(a,b,c){b==null&&(b=0),c==null&&(c=0)},Bitmap.prototype.applyFilter=function(a,b,c,d){},Bitmap}()})).call(this)},"display/Blend":function(a,b,c){((function(){var Blend,a,b,d,e;d=function(a,b,c){return a+((b-a)*c>>8)},e=function(a){return a<0?0:a>255?255:a},b=Math.min,a=Math.max,c.exports=Blend={scan:function(a,b,c){var d,e,f,g,h,i;c=this[c];if(c==null)throw new TypeError(""+c+" isn't defined.");d=a.data,g=b.data;for(e=0,h=d.length;e<h;e+=4)f=c(d[e],d[e+1],d[e+2],d[e+3],g[e],g[e+1],g[e+2],g[e+3]),[].splice.apply(d,[e,e+3-e+1].concat(i=f.slice(0,4))),i;return a},blend:function(a,b,c,e,f,g,h,i){return[d(a,f,i),d(b,g,i),d(c,h,i),e+i]},add:function(a,b,c,d,e,f,g,h){return[a+(e*h>>8),b+(f*h>>8),c+(g*h>>8),d+h]},subtract:function(a,b,c,d,e,f,g,h){return[a-(e*h>>8),b-(f*h>>8),c-(g*h>>8),d+h]},darkest:function(a,c,e,f,g,h,i,j){return[d(a,b(a,g*j>>8),j),d(c,b(c,h*j>>8),j),d(e,b(e,i*j>>8),j),f+j]},lightest:function(b,c,d,e,f,g,h,i){return[a(b,f*i>>8),a(c,g*i>>8),a(d,h*i>>8),e+i]},difference:function(a,b,c,e,f,g,h,i){return[d(a,a>f?a-f:f-a,i),d(b,b>g?b-g:g-b,i),d(c,c>h?c-h:h-c,i),e+i]},exclusion:function(a,b,c,e,f,g,h,i){return[d(a,a+f-(a*f>>7),i),d(b,b+g-(b*g>>7),i),d(c,c+h-(c*h>>7),i),e+i]},reflex:function(a,b,c,e,f,g,h,i){return[d(a,f===255?f:a*a/(255-f),i),d(b,g===255?g:b*b/(255-g),i),d(c,h===255?h:c*c/(255-h),i),e+i]},multiply:function(a,b,c,e,f,g,h,i){return[d(a,a*f>>8,i),d(b,b*g>>8,i),d(c,c*h>>8,i),e+i]},screen:function(a,b,c,e,f,g,h,i){return[d(a,255-((255-a)*(255-f)>>8),i),d(b,255-((255-b)*(255-g)>>8),i),d(c,255-((255-c)*(255-h)>>8),i),e+i]},overlay:function(a,b,c,e,f,g,h,i){return[d(a,a<128?a*f>>7:255-((255-a)*(255-f)>>7),i),d(b,b<128?b*g>>7:255-((255-b)*(255-g)>>7),i),d(c,c<128?c*h>>7:255-((255-c)*(255-h)>>7),i),e+i]},softLight:function(a,b,c,e,f,g,h,i){return[d(a,(a*f>>7)+(a*a>>8)-(a*a*f>>15),i),d(b,(b*g>>7)+(b*b>>8)-(b*b*g>>15),i),d(c,(c*h>>7)+(c*c>>8)-(c*c*h>>15),i),e+i]},hardLight:function(a,b,c,e,f,g,h,i){return[d(a,f<128?a*f>>7:255-((255-a)*(255-f)>>7),i),d(b,g<128?b*g>>7:255-((255-b)*(255-g)>>7),i),d(c,h<128?c*h>>7:255-((255-c)*(255-h)>>7),i),e+i]},vividLight:function(a,b,c,d,f,g,h,i){return[f===0?0:f===255?255:f<128?255-e((255-a<<8)/(f*2)):e((a<<8)/((255-f)*2)),g===0?0:g===255?255:g<128?255-e((255-b<<8)/(g*2)):e((b<<8)/((255-g)*2)),h===0?0:h===255?255:h<128?255-e((255-c<<8)/(h*2)):e((c<<8)/((255-h)*2)),d+i]},linearLight:function(c,d,e,f,g,h,i,j){return[g<128?a(g*2+c-255,0):b(g+c,255),h<128?a(h*2+d-255,0):b(h+d,255),i<128?a(i*2+e-255,0):b(i+e,255),f+j]},pinLight:function(c,d,e,f,g,h,i,j){return[g<128?b(g*2,c):a((g-128)*2,c),h<128?b(h*2,d):a((h-128)*2,d),i<128?b(i*2,e):a((i-128)*2,e),f+j]},hardMix:function(a,b,c,d,f,g,h,i){var j,k,l;return l=f===0?0:f===255?255:f<128?255-e((255-a<<8)/(f*2)):e((a<<8)/((255-f)*2)),k=g===0?0:g===255?255:g<128?255-e((255-b<<8)/(g*2)):e((b<<8)/((255-g)*2)),j=h===0?0:h===255?255:h<128?255-e((255-c<<8)/(h*2)):e((c<<8)/((255-h)*2)),[l<128?0:255,k<128?0:255,j<128?0:255,d+i]},dodge:function(a,b,c,f,g,h,i,j){return[d(a,e((a<<8)/(255-g)),j),d(b,e((b<<8)/(255-h)),j),d(c,e((c<<8)/(255-i)),j),f+j]},burn:function(a,b,c,f,g,h,i,j){return[d(a,g===0?0:255-e((255-a<<8)/g),j),d(b,h===0?0:255-e((255-b<<8)/h),j),d(c,i===0?0:255-e((255-c<<8)/i),j),f+j]},linearDodge:function(a,c,e,f,g,h,i,j){return[d(a,b(g+a,255),j),d(c,b(c+h,255),j),d(e,b(e+i,255),j),f+j]},linearBurn:function(b,c,e,f,g,h,i,j){return[d(b,a(g+b-255,0),j),d(c,a(c+h-255,0),j),d(e,a(e+i-255,0),j),f+j]}}})).call(this)},"display/BlendMode":function(a,b,c){((function(){var BlendMode;c.exports=BlendMode={NORMAL:"normal",BLEND:"blend",ADD:"add",SUBTRACT:"subtract",DARKEST:"darkest",LIGHTEST:"lightest",DIFFERENCE:"difference",EXCLUSION:"exclusion",MULTIPLY:"multiply",SCREEN:"screen",OVERLAY:"overlay",SOFT_LIGHT:"softLight",HARD_LIGHT:"hardLight",VIVID_LIGHT:"vividLight",LINEAR_LIGHT:"linearLight",PIN_LIGHT:"pinLight",HARD_MIX:"hardMix",DODGE:"dodge",BURN:"burn",LINEAR_DODGE:"linearDodge",LINEAR_BURN:"linearBurn"}})).call(this)},"display/CapsStyle":function(a,b,c){((function(){var CapsStyle;c.exports=CapsStyle={NONE:"butt",BUTT:"butt",ROUND:"round",SQUARE:"square"}})).call(this)},"display/DisplayObject":function(a,b,c){((function(){var BlendMode,DisplayObject,EventDispatcher,Matrix,Rectangle,Vector,a,d=Object.prototype.hasOwnProperty,e=function(a,b){function e(){this.constructor=a}for(var c in b)d.call(b,c)&&(a[c]=b[c]);return e.prototype=b.prototype,a.prototype=new e,a.__super__=b.prototype,a};EventDispatcher=b("events/EventDispatcher"),BlendMode=b("display/BlendMode"),Matrix=b("geom/Matrix"),Vector=b("geom/Vector"),Rectangle=b("geom/Rectangle"),a=Math.PI/180,c.exports=DisplayObject=function(){function DisplayObject(){DisplayObject.__super__.constructor.call(this),this.defineProperty("stage",function(){return this.__stage},function(a){this.__stage=a}),this.defineProperty("parent",function(){return this._parent}),this.defineProperty("x",function(){return this._x},function(a){this._x=a,this._requestRender(!1)}),this.defineProperty("y",function(){return this._y},function(a){this._y=a,this._requestRender(!1)}),this.defineProperty("alpha",function(){return this._alpha},function(a){this._alpha=a,this._requestRender(!1)}),this.defineProperty("rotation",function(){return this._rotation},function(a){this._rotation=a,this._requestRender(!1)}),this.defineProperty("width",this._getWidth,this._setWidth),this.defineProperty("height",this._getHeight,this._setHeight),this.defineProperty("scaleX",function(){return this._scaleX},function(a){this._scaleX=a,this._width=this._context.canvas.width*a,this._requestRender(!1)}),this.defineProperty("scaleY",function(){return this._scaleY},function(a){this._scaleY=a,this._height=this._context.canvas.height*a,this._requestRender(!1)}),this.defineProperty("matrix",function(){return this._matrix},function(a){this._matrix=a,this._requestRender(!1)}),this.__stage=null,this._parent=null,this._x=0,this._y=0,this._width=0,this._height=0,this._scaleX=1,this._scaleY=1,this._rotation=0,this._alpha=1,this._matrix=new Matrix,this.blendMode=BlendMode.NORMAL,this.filters=[],this._context=document.createElement("canvas").getContext("2d"),this._context.canvas.width=this._context.canvas.height=0,this._stacks=[],this._drawn=!1,this._measured=!1}return e(DisplayObject,EventDispatcher),DisplayObject.prototype._getWidth=function(){return this._measureSize(),this._width},DisplayObject.prototype._setWidth=function(a){this._width=a,this._context.canvas.width!==0&&(this._scaleX=a/this._context.canvas.width),this._requestRender(!1)},DisplayObject.prototype._getHeight=function(){return this._measureSize(),this._height},DisplayObject.prototype._setHeight=function(a){this._height=a,this._context.canvas.height!==0&&(this._scaleY=a/this._context.canvas.height),this._requestRender(!1)},DisplayObject.prototype._getTransform=function(){return this._matrix.clone().createBox(this._scaleX,this._scaleY,this._rotation*a,this._x,this._y)},DisplayObject.prototype.set=function(a,b){return this[a]=b,this},DisplayObject.prototype.addTo=function(a){if(a instanceof Sprite)return a.addChild(this),this;throw new TypeError("parent "+a+" isn't display object container")},DisplayObject.prototype._requestRender=function(a){return a==null&&(a=!1),this._drawn|=a,this._measured=!1,this._parent!=null&&this._parent._requestRender(!0),this},DisplayObject.prototype._render=function(){return this._drawn=!1,this._measureSize(),this._applySize(),this._execStacks(),this._applyFilters()},DisplayObject.prototype._measureSize=function(){var a,b,c,d,e,f,g,h;if(!this._measured){c=0,h=this._stacks;for(f=0,g=h.length;f<g;f++)e=h[f],e.delta!=null&&(c=e.delta),e.rect!=null&&(typeof d=="undefined"||d===null?d=e.rect.clone():d.union(e.rect),a=e.rect.clone(),a.offset(-c/2,-c/2),a.inflate(c,c),typeof b=="undefined"||b===null?b=a:b.union(a));d==null&&(d=new Rectangle),b==null?b=new Rectangle:b.adjustOuter(),this._width=d.width,this._height=d.height,this._rect=d,this._bounds=b,this._measured=!0}},DisplayObject.prototype._applySize=function(){return this._context.canvas.width=this._bounds.width,this._context.canvas.height=this._bounds.height},DisplayObject.prototype._execStacks=function(){var a,b,c,d;this._context.translate(-this._bounds.x,-this._bounds.y),d=this._stacks;for(b=0,c=d.length;b<c;b++)a=d[b],this["_"+a.method].apply(this,a.arguments);return this._context.setTransform(1,0,0,1,0,0)},DisplayObject.prototype._applyFilters=function(){var a,b,c,d,e,f;if(this.filters.length>0){b=this._context.getImageData(0,0,this._bounds.width,this._bounds.height),c=this._context.createImageData(this._bounds.width,this._bounds.height),f=this.filters;for(d=0,e=f.length;d<e;d++)a=f[d],a.scan(b,c);this._context.putImageData(c,0,0)}},DisplayObject.prototype._drawBounds=function(){return this._context.strokeStyle="rgba(0, 0, 255, .8)",this._context.lineWidth=1,this._context.strokeRect(0,0,this._context.canvas.width,this._context.canvas.height)},DisplayObject.prototype.hitTestPoint=function(a){return this.hitTest(a.x,a.y)},DisplayObject.prototype.hitTest=function(a,b){var c;return c=this.globalToLocal(a,b),this._hitTest(c.x,c.y)},DisplayObject.prototype._hitTest=function(a,b){return this._bounds.contains(a,b)},DisplayObject.prototype.globalToLocalPoint=function(a){return this.globalToLocal(a.x,a.y)},DisplayObject.prototype.globalToLocal=function(a,b){var c;c=this;while(c)a-=c.x,b-=c.y,c=c._parent;return new Vector(a,b)},DisplayObject}()})).call(this)},"display/GradientType":function(a,b,c){((function(){var GradientType;c.exports=GradientType={LINEAR:"linear",RADIAL:"radial"}})).call(this)},"display/Graphics":function(a,b,c){((function(){var CapsStyle,GradientType,Graphics,JointStyle,Rectangle,Vector,a,d,e,f;GradientType=b("display/GradientType"),CapsStyle=b("display/CapsStyle"),JointStyle=b("display/JointStyle"),Vector=b("geom/Vector"),Rectangle=b("geom/Rectangle"),d=Math.PI,e=d/2,f=d*2,a=(Math.SQRT2-1)*4/3,c.exports=Graphics=function(){function Graphics(a){this._displayObject=a,this._context=this._displayObject._context,this._stacks=this._displayObject._stacks}return Graphics.toColorString=function(a,b){return a==null&&(a=0),b==null&&(b=1),"rgba("+(a>>16&255)+","+(a>>8&255)+","+(a&255)+","+(b<0?0:b>1?1:b)+")"},Graphics.prototype._requestRender=function(){return this._displayObject._requestRender.apply(this._displayObject,arguments),this},Graphics.prototype._execStacks=function(){var a,b,c,d,e,f,g;this._context.fillStyle=this._context.strokeStyle="rgba(0,0,0,0)",this._context.translate(-this._displayObject._bounds.x,-this._displayObject._bounds.y),a=0,g=this._stacks;for(b=0,f=g.length;b<f;b++)e=g[b],d=e.method,c=d.indexOf("draw")===0,d==="moveTo"||d==="lineTo"||d==="quadraticCurveTo"||d==="cubicCurveTo"||c?a++:a!==0&&(a=0,c&&this._context.closePath(),this._context.fill(),this._context.stroke()),a===1&&this._context.beginPath(),this["_"+e.method].apply(this,e.arguments);return a!==0&&(a=0,c&&this._context.closePath(),this._context.fill(),this._context.stroke()),this._context.setTransform(1,0,0,1,0,0)},Graphics.prototype.clear=function(){while(this._stacks.length)this._stacks.pop();return this._context.canvas.width=this._context.canvas.height=0,this._requestRender(!0)},Graphics.prototype.lineStyle=function(a,b,c,d,e,f){return a==null&&(a=1),b==null&&(b=0),c==null&&(c=1),d==null&&(d=CapsStyle.NONE),e==null&&(e=JointStyle.BEVEL),f==null&&(f=10),this._stacks.push({method:"lineStyle",arguments:[a,b,c,d,e,f],delta:a}),this._requestRender(!0)},Graphics.prototype._lineStyle=function(a,b,c,d,e,f){this._context.lineWidth=a,this._context.strokeStyle=Graphics.toColorString(b,c),this._context.lineCaps=d,this._context.lineJoin=e,this._context.miterLimit=f},Graphics.prototype.beginFill=function(a,b){return a==null&&(a=0),b==null&&(b=1),this._stacks.push({method:"beginFill",arguments:[a,b]}),this._requestRender(!0)},Graphics.prototype._beginFill=function(a,b){this._context.fillStyle=Graphics.toColorString(a,b)},Graphics.prototype.beginGradientFill=function(a,b,c,d,e,f){return e==null&&(e=null),f==null&&(f=0),this._stacks.push({method:"beginGradientFill",arguments:[a,b,c,d,e,f]}),this._requestRender(!0)},Graphics.prototype._beginGradientFill=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I;v=d.length;if(b.length!==v||c.length!==v)throw new TypeError("Invalid length of colors, alphas or ratios.");q=e.transformPoint(new Vector(-819.2,-819.2)),k=e.transformPoint(new Vector(819.2,819.2)),j=e.transformPoint(new Vector(-819.2,819.2)),z=k.subtract(q).divide(2),l=q.add(z);switch(a){case"linear":y=j.subtract(q),r=z.magnitude*Math.abs(Math.sin(z.direction-y.direction)),C=y.rotate(Math.PI/2).normalize(r),p=l.add(C),m=l.subtract(C),t=this._context.createLinearGradient(p.x,p.y,m.x,m.y);break;case"radial":o=e.transformPoint(new Vector(819.2,0)),D=o.subtract(l),n=q.add(j).divide(2),i=k.add(j).divide(2),B=n.subtract(l),A=i.subtract(l),E=B.x*B.x,G=B.y*B.y,F=A.x*A.x,H=A.y*A.y,g=Math.sqrt((G*F-E*H)/(G-H)),h=Math.sqrt((E*H-G*F)/(E-F)),w=Math.max(g,h),s=w*f,t=this._context.createRadialGradient(l.x,l.y,w,l.x+s*Math.cos(D.direction),l.y+s*Math.sin(D.direction),0),d=d.slice(),d.reverse()}for(u=0,I=d.length;u<I;u++)x=d[u],t.addColorStop(x/255,Graphics.toColorString(b[u],c[u]));return this._context.fillStyle=t},Graphics.prototype.endFill=function(a,b){return a==null&&(a=0),b==null&&(b=1),this._stacks.push({method:"endFill",arguments:[a,b]}),this._requestRender(!0)},Graphics.prototype._endFill=function(a,b){},Graphics.prototype.moveTo=function(a,b){return this._stacks.push({method:"moveTo",arguments:[a,b],rect:new Rectangle(a,b,0,0)}),this._requestRender(!0)},Graphics.prototype._moveTo=function(a,b){this._context.moveTo(a,b)},Graphics.prototype.lineTo=function(a,b,c){return this._stacks.push({method:"lineTo",arguments:[a,b],rect:new Rectangle(a,b,0,0)}),this._requestRender(!0)},Graphics.prototype._lineTo=function(a,b){this._context.lineTo(a,b)},Graphics.prototype.drawPath=function(a,b,c){var d,e,f,g;c==null&&(c=0),f=new Rectangle(b[0],b[1],0,0);for(d=1,g=b.length/2;d<g;d+=1)e=d*2,f.contain(b[e],b[e+1]);return this._stacks.push({method:"drawPath",arguments:[a,b,c],rect:f}),this._requestRender(!0)},Graphics.prototype._drawPath=function(a,b,c){var d,e,f,g,h,i,j,k;if(c<0){f=[],g=0;for(h=0,j=a.length;h<j;h++){e=a[h];switch(e){case 0:case 1:f.unshift(b[g++],b[g++]);break;case 2:g+=4,f.unshift(b[g-2],b[g-1],b[g-4],b[g-3]);break;case 3:g+=6,f.unshift(b[g-2],b[g-1],b[g-4],b[g-3],b[g-6],b[g-5])}}b=f,a=a.slice(),d=a.shift(),a.reverse(),a.unshift(d)}g=0;for(i=0,k=a.length;i<k;i++){e=a[i];switch(e){case 0:this._context.moveTo(b[g++],b[g++]);break;case 1:this._context.lineTo(b[g++],b[g++]);break;case 2:this._context.quadraticCurveTo(b[g++],b[g++],b[g++],b[g++]);break;case 3:this._context.bezierCurveTo(b[g++],b[g++],b[g++],b[g++],b[g++],b[g++])}}if(b[0]===b[b.length-2]&&b[1]===b[b.length-1])return this._context.closePath()},Graphics.prototype.quadraticCurveTo=function(a,b,c,d){return this._stacks.push({method:"quadraticCurveTo",arguments:[a,b,c,d],rect:(new Rectangle(a,b)).contain(c,d)}),this._requestRender(!0)},Graphics.prototype.curveTo=Graphics.prototype.quadraticCurveTo,Graphics.prototype._quadraticCurveTo=function(a,b,c,d){return this._context.quadraticCurveTo(a,b,c,d)},Graphics.prototype.cubicCurveTo=function(a,b,c,d,e,f){return this._stacks.push({method:"cubicCurveTo",arguments:[a,b,c,d,e,f],rect:(new Rectangle(a,b)).contain(c,d).contain(e,f)}),this._requestRender(!0)},Graphics.prototype.bezierCurveTo=Graphics.prototype.cubicCurveTo,Graphics.prototype._cubicCurveTo=function(a,b,c,d,e,f){return this._context.bezierCurveTo(a,b,c,d,e,f)},Graphics.prototype.drawRectangle=function(a,b){return b==null&&(b=0),this.drawRect(a.x,a.y,a.width,a.height,b)},Graphics.prototype.drawRect=function(a,b,c,d,e){var f,g;return d==null&&(d=c),e==null&&(e=0),e===0?(this._stacks.push({method:"drawRect",arguments:[a,b,c,d],rect:new Rectangle(a,b,c,d)}),this._requestRender(!0)):(g=a+c,f=b+d,this.drawPath([0,1,1,1,1],[a,b,g,b,g,f,a,f,a,b],e))},Graphics.prototype._drawRect=function(a,b,c,d){return this._context.fillRect(a,b,c,d),this._context.strokeRect(a,b,c,d)},Graphics.prototype.drawRoundRectangle=function(a,b,c,d){return c==null&&(c=b),d==null&&(d=0),this.drawRoundRect(a.x,a.y,a.width,a.height,b,c,d)},Graphics.prototype.drawRoundRect=function(a,b,c,d,e,f,g){return f==null&&(f=e),g==null&&(g=0),this.drawPath([0,1,2,1,2,1,2,1,2],[a+e,b,a+c-e,b,a+c,b,a+c,b+f,a+c,b+d-f,a+c,b+d,a+c-e,b+d,a+e,b+d,a,b+d,a,b+d-f,a,b+f,a,b,a+e,b],g)},Graphics.prototype.drawCircle=function(a,b,c,d){return d==null&&(d=0),this._stacks.push({method:"drawCircle",arguments:[a,b,c,d],rect:new Rectangle(a-c,b-c,c*2,c*2)}),this._requestRender(!0)},Graphics.prototype._drawCircle=function(a,b,c,d){this._context.moveTo(a+c,b),this._context.arc(a,b,c,0,f,d<0)},Graphics.prototype.drawEllipse=function(b,c,d,e,f){var g,h;return f==null&&(f=0),d/=2,e/=2,b+=d,c+=e,h=d*a,g=e*a,this.drawPath([0,3,3,3,3],[b+d,c,b+d,c+g,b+h,c+e,b,c+e,b-h,c+e,b-d,c+g,b-d,c,b-d,c-g,b-h,c-e,b,c-e,b+h,c-e,b+d,c-g,b+d,c],f)},Graphics.prototype.drawRegularPolygon=function(a,b,c,d,g){var h,i,j,k,l;d==null&&(d=3),g==null&&(g=0),h=[],i=[],l=f/d;for(j=0;0<=d?j<=d:j>=d;0<=d?j++:j--)h.push(j===0?0:1),k=-e+l*j,i.push(a+c*Math.cos(k),b+c*Math.sin(k));return this.drawPath(h,i,g)},Graphics.prototype.drawRegularStar=function(a,b,c,e,f){var g;return e==null&&(e=5),f==null&&(f=0),g=Math.cos(d/e),this.drawStar(a,b,c,c*(2*g-1/g),e,f)},Graphics.prototype.drawStar=function(a,b,c,f,g,h){var i,j,k,l,m,n,o;g==null&&(g=5),h==null&&(h=0),i=[],j=[],n=d/g;for(k=0,o=g*2;k<=o;k+=1)i.push(k===0?0:1),l=(k&1)===0?c:f,m=-e+n*k,j.push(a+l*Math.cos(m),b+l*Math.sin(m));return this.drawPath(i,j,h)},Graphics}()})).call(this)},"display/InteractiveObject":function(a,b,c){((function(){var DisplayObject,EventPhase,InteractiveObject,MouseEvent,Vector,a,d=function(a,b){return function(){return a.apply(b,arguments)}},e=Object.prototype.hasOwnProperty,f=function(a,b){function d(){this.constructor=a}for(var c in b)e.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};DisplayObject=b("display/DisplayObject"),EventPhase=b("events/EventPhase"),MouseEvent=b("events/MouseEvent"),Vector=b("geom/Vector"),a=Math.PI/180,c.exports=InteractiveObject=function(){function InteractiveObject(){this._drag=d(this._drag,this),InteractiveObject.__super__.constructor.call(this)}return f(InteractiveObject,DisplayObject),InteractiveObject.prototype._hitTest=function(a,b){return this._context.isPointInPath(a-this._bounds.x,b-this._bounds.y)},InteractiveObject.prototype._propagateMouseEvent=function(a){var b,c,d,e,f;if(this._mouseEnabled&&a._isPropagationStopped===!1){a=a.clone(),f=this._getTransform().invert().transformPoint(new Vector(a.localX,a.localY)),a.localX=f.x,a.localY=f.y,d=this._hitTest(a.localX,a.localY),d===!0&&this._mouseIn===!1?(c=a.clone(),c.type=MouseEvent.MOUSE_OVER,this._targetMouseEvent(c),c=a.clone(),c.type=MouseEvent.ROLL_OVER,c.bubbles=!1,this._targetMouseEvent(c),this._mouseIn=!0,this._buttonMode&&(this.__stage._canvas.style.cursor="pointer")):d===!1&&this._mouseIn===!0&&(c=a.clone(),c.type=MouseEvent.MOUSE_OUT,this._targetMouseEvent(c),c=a.clone(),c.type=MouseEvent.ROLL_OUT,c.bubbles=!1,this._targetMouseEvent(c),this._mouseIn=!1,this!==this.__stage&&(this.__stage._canvas.style.cursor="default"));if(this._mouseChildren){e=this._children.length;while(e--){b=this._children[e];if(b._propagateMouseEvent!=null){c=b._propagateMouseEvent(a);if(c!=null){this._captureMouseEvent(c);return}}if(typeof b._hitTest=="function"?b._hitTest(a.localX-b.x,a.localY-b.y):void 0)d=!0}}if(d)return this._targetMouseEvent(a)}},InteractiveObject.prototype._captureMouseEvent=function(a){return a=a.clone(),a.eventPhase=EventPhase.CAPTURING_PHASE,a.currentTarget=this,this.dispatchEvent(a),a},InteractiveObject.prototype._targetMouseEvent=function(a){var b;return a=a.clone(),a.eventPhase=EventPhase.AT_TARGET,a.target=a.currentTarget=this,this.dispatchEvent(a),a.bubbles&&(b=this._parent)!=null&&b._bubbleMouseEvent(a),a},InteractiveObject.prototype._bubbleMouseEvent=function(a){var b;return a=a.clone(),a.eventPhase=EventPhase.BUBBLING_PHASE,a.currentTarget=this,this.dispatchEvent(a),(b=this._parent)!=null&&b._bubbleMouseEvent(a),a},InteractiveObject.prototype.startDrag=function(a){return a==null&&(a=!1),this.__stage.addEventListener(MouseEvent.MOUSE_MOVE,this._drag)},InteractiveObject.prototype._drag=function(a){return this.x=a.stageX,this.y=a.stageY},InteractiveObject.prototype.stopDrag=function(){return this.__stage.removeEventListener(MouseEvent.MOUSE_MOVE,this._drag)},InteractiveObject}()})).call(this)},"display/JointStyle":function(a,b,c){((function(){var JointStyle;c.exports=JointStyle={BEVEL:"bevel",MITER:"miter",ROUND:"round"}})).call(this)},"display/Loader":function(a,b,c){((function(){var Bitmap,Loader,Sprite,a=Object.prototype.hasOwnProperty,d=function(b,c){function e(){this.constructor=b}for(var d in c)a.call(c,d)&&(b[d]=c[d]);return e.prototype=c.prototype,b.prototype=new e,b.__super__=c.prototype,b};Bitmap=b("display/Bitmap"),Sprite=b("display/Sprite"),c.exports=Loader=function(){function Loader(){Loader.__super__.constructor.call(this)}return d(Loader,Sprite),Loader.prototype.load=function(a){var b,c=this;return b=new Image,b.src=a,b.addEventListener("load",function(a){var d;return d=new Bitmap,d.draw(b),c.content=d,c.addChild(c.content),c.dispatchEvent(new Event(Event.COMPLETE))})},Loader}()})).call(this)},"display/Shape":function(a,b,c){((function(){var DisplayObject,Graphics,Shape,a=Object.prototype.hasOwnProperty,d=function(b,c){function e(){this.constructor=b}for(var d in c)a.call(c,d)&&(b[d]=c[d]);return e.prototype=c.prototype,b.prototype=new e,b.__super__=c.prototype,b};DisplayObject=b("display/DisplayObject"),Graphics=b("display/Graphics"),c.exports=Shape=function(){function Shape(){Shape.__super__.constructor.call(this),this.graphics=new Graphics(this)}return d(Shape,DisplayObject),Shape.prototype._execStacks=function(){this.graphics._execStacks()},Shape.prototype.hitTestPoint=function(a){return this.hitTest(a.x,a.y)},Shape.prototype.hitTest=function(a,b){var c;return c=this.globalToLocal(a,b),this._bounds.containsPoint(c)?this._hitTest(c.x,c.y):!1},Shape.prototype._hitTest=function(a,b){return this._context.isPointInPath(a-this._bounds.x,b-this._bounds.y)},Shape.prototype.clip=function(){return this._stacks.push({method:"clip",arguments:ArrayUtil.toArray(arguments)}),this._requestRender(!0)},Shape.prototype._clip=function(){this._context.clip()},Shape}()})).call(this)},"display/Sprite":function(a,b,c){((function(){var Blend,BlendMode,Graphics,InteractiveObject,Sprite;Graphics=b("display/Graphics"),InteractiveObject=b("display/InteractiveObject"),Blend=b("display/Blend"),BlendMode=b("display/BlendMode"),c.exports=Sprite=function(){function Sprite(){Sprite.__super__.constructor.call(this),this.defineProperty("_stage",null,function(a){var b,c,d,e;e=this._children;for(c=0,d=e.length;c<d;c++)b=e[c],b._stage=a;this.__stage=a}),this.defineProperty("mouseEnabled",function(){return this._mouseEnabled},function(a){return this._mouseEnabled=a}),this.defineProperty("mouseChildren",function(){return this._mouseChildren},function(a){return this._mouseChildren=a}),this.defineProperty("buttonMode",function(){return this._buttonMode},function(a){return this._buttonMode=a}),this.graphics=new Graphics(this),this._children=[],this._mouseEnabled=!0,this._mouseChildren=!0,this._buttonMode=!1,this._mouseIn=!1}return __extends(Sprite,InteractiveObject),Sprite.prototype._execStacks=function(){this.graphics._execStacks()},Sprite.prototype.addChild=function(){var a,b,c,d;b=1<=arguments.length?__slice.call(arguments,0):[];for(c=0,d=b.length;c<d;c++)a=b[c],a._stage=this.__stage,a._parent=this,this._children.push(a);return this._requestRender(!0)},Sprite.prototype.addChildAt=function(a,b){if(b<0||b>this._children.length)throw new TypeError("index is out of range");return this._children.splice(b,0,a),this._requestRender(!0)},Sprite.prototype.removeChild=function(){var a,b,c,d,e;b=1<=arguments.length?__slice.call(arguments,0):[];for(d=0,e=b.length;d<e;d++)a=b[d],c=this._children.indexOf(a),c!==-1&&this._children.splice(c,1);return this._requestRender(!0)},Sprite.prototype._render=function(){return this._drawn=!1,this._measureSize(),this._applySize(),this._execStacks(),this._drawChildren(),this._applyFilters()},Sprite.prototype._measureSize=function(){var a,b,c,d,e,f,g,h,i;Sprite.__super__._measureSize.call(this),d=this._rect,b=this._bounds,i=this._children;for(g=0,h=i.length;g<h;g++)c=i[g],d.union(c._rect),a=c._bounds.clone(),a.x+=c.x,a.y+=c.y,b.union(a);e=Math.floor(b.x),e!==b.x&&b.width++,f=Math.floor(b.y),f!==b.y&&b.height++,b.x=e,b.y=f,b.width=Math.ceil(b.width),b.height=Math.ceil(b.height),this._width=d.width,this._height=d.height,this._rect=d,this._bounds=b},Sprite.prototype._drawBounds=function(){this._context.strokeStyle="rgba(255, 0, 0, .8)",this._context.lineWidth=1,this._context.strokeRect(0,0,this._width,this._height)},Sprite.prototype._drawChildren=function(){var a,b,c,d,e,f;f=this._children;for(d=0,e=f.length;d<e;d++){a=f[d];if(a._bounds!=null&&a._bounds.width>0&&a._bounds.height>0){if(isNaN(a.x||isNaN(a._bounds.x||isNaN(a.y||isNaN(a._bounds.y)))))throw new Error("invalid position");a._drawn&&a._render(),a._getTransform().setTo(this._context),this._context.globalAlpha=a._alpha<0?0:a._alpha>1?1:a._alpha,a.blendMode===BlendMode.NORMAL?this._context.drawImage(a._context.canvas,a._bounds.x-this._bounds.x,a._bounds.y-this._bounds.y):(c=this._context.getImageData(a._bounds.x-this._bounds.x,a._bounds.y-this._bounds.y,a._bounds.width,a._bounds.height),b=a._context.getImageData(0,0,a._bounds.width,a._bounds.height),this._context.putImageData(Blend.scan(c,b,a.blendMode),a._bounds.x-this._bounds.x,a._bounds.y-this._bounds.y)),this._context.setTransform(1,0,0,1,0,0)}}},Sprite.prototype.hitTestPoint=function(a,b){var c,d,e,f;c=this._bounds.clone().offset(this.x,this.y),e=!1;if(c.contains(a,b)){e=this._context.isPointInPath(a-c.x,b-c.y);if(!e){f=this._children.length;while(f--){d=this._children[f],e|=d.hitTestPoint(a-this.x,b-this.y);if(e)break}}}return e},Sprite}()})).call(this)},"display/Stage":function(a,b,c){((function(){var Event,EventPhase,MouseEvent,Rectangle,Sprite,Stage,TextField,TextFormat,Ticker,a=function(a,b){return function(){return a.apply(b,arguments)}},d=Object.prototype.hasOwnProperty,e=function(a,b){function e(){this.constructor=a}for(var c in b)d.call(b,c)&&(a[c]=b[c]);return e.prototype=b.prototype,a.prototype=new e,a.__super__=b.prototype,a};Sprite=b("display/Sprite"),Event=b("events/Event"),EventPhase=b("events/EventPhase"),MouseEvent=b("events/MouseEvent"),Rectangle=b("geom/Rectangle"),TextField=b("text/TextField"),TextFormat=b("text/TextFormat"),Ticker=b("timers/Ticker"),c.exports=Stage=function(){function Stage(b,c){var d;c==null&&(c=null),this._onMouseWheel=a(this._onMouseWheel,this),this._onMouseMove=a(this._onMouseMove,this),this._onMouseUp=a(this._onMouseUp,this),this._onMouseDown=a(this._onMouseDown,this),this._onClick=a(this._onClick,this),this._enterFrame=a(this._enterFrame,this),Stage.__super__.constructor.call(this),this.defineProperty("frameRate",function(){return this._frameRate});if(b instanceof HTMLCanvasElement)d=b,this._width=d.width,this._height=d.height;else if(!isNaN(Number(b))&&!isNaN(Number(c)))d=document.createElement("canvas"),this._width=d.width=b,this._height=d.height=c;else throw new TypeError("");this._canvas=d,this.__stage=this,this._context=d.getContext("2d"),this._bounds=new Rectangle(0,0,d.width,d.height),this.overrideMouseWheel=!1,this._startTime=this._time=(new Date).getTime(),this.currentFrame=0,this._frameRate=60,Ticker.getInstance().addHandler(this._enterFrame),d.addEventListener("click",this._onClick,!1),d.addEventListener("mousedown",this._onMouseDown,!1),d.addEventListener("mouseup",this._onMouseUp,!1),d.addEventListener("mousemove",this._onMouseMove,!1),d.addEventListener("mousewheel",this._onMouseWheel,!1)}return e(Stage,Sprite),Stage.prototype._getWidth=function(){return this._width},Stage.prototype._getHeight=function(){return this._height},Stage.prototype.getTimer=function(){return(new Date).getTime()-this._startTime},Stage.prototype._enterFrame=function(a){this.currentFrame++,this.currentFrame%30===0&&(this._frameRate=(3e5/(a-this._time)>>0)/10,this._time=a),this.dispatchEvent(new Event(Event.ENTER_FRAME)),this._drawn&&(this._drawn=!1,this._render())},Stage.prototype._render=function(){var a,b,c,d;d=this._children;for(b=0,c=d.length;b<c;b++)a=d[b],a._drawn&&a._render();this._context.canvas.width=this._width,this._drawChildren()},Stage.prototype._requestRender=function(){this._drawn=!0},Stage.prototype._hitTest=function(a,b){return this._bounds.contains(a,b)},Stage.prototype._onClick=function(a){var b;return a.preventDefault(),b=new MouseEvent(MouseEvent.CLICK,!0),this._setMousePosition(b,a),this._propagateMouseEvent(b)},Stage.prototype._onMouseDown=function(a){var b;return a.preventDefault(),b=new MouseEvent(MouseEvent.MOUSE_DOWN,!0),this._setMousePosition(b,a),this._propagateMouseEvent(b)},Stage.prototype._onMouseUp=function(a){var b;return a.preventDefault(),b=new MouseEvent(MouseEvent.MOUSE_UP,!0),this._setMousePosition(b,a),this._propagateMouseEvent(b)},Stage.prototype._onMouseMove=function(a){var b;return a.preventDefault(),b=new MouseEvent(MouseEvent.MOUSE_MOVE,!0),this._setMousePosition(b,a),this._propagateMouseEvent(b)},Stage.prototype._onMouseWheel=function(a){var b;return this.overrideMouseWheel&&a.preventDefault(),b=new MouseEvent(MouseEvent.MOUSE_WHEEL,!0),this._setMousePosition(b,a),this._propagateMouseEvent(b)},Stage.prototype._setMousePosition=function(a,b){return a.stageX=a.localX=b.offsetX!=null?b.offsetX:b.pageX-this._canvas.offsetLeft,a.stageY=a.localY=b.offsetY!=null?b.offsetY:b.pageY-this._canvas.offsetTop,a.delta=b.wheelDelta!=null?b.wheelDelta:b.detail!=null?b.detail:0},Stage}()})).call(this)},"events/Event":function(a,b,c){((function(){var Event,a=Array.prototype.slice;c.exports=Event=function(){function Event(a,b,c){this.type=a,this.bubbles=b!=null?b:!1,this.cancelable=c!=null?c:!1,this._isPropagationStopped=!1,this._isPropagationStoppedImmediately=!1,this._isDefaultPrevented=!1}return Event.ENTER_FRAME="enterFrame",Event.COMPLETE="complete",Event.prototype.clone=function(){var a;return a=new Event(this.type,this.bubbles,this.cancelable),a.currentTarget=this.currentTarget,a.target=this.target,a},Event.prototype.formatToString=function(){var b,c;return c=arguments[0],b=2<=arguments.length?a.call(arguments,1):[],""},Event.prototype.stopPropagation=function(){this._isPropagationStopped=!0},Event.prototype.stopImmediatePropagation=function(){this._isPropagationStopped=!0,this._isPropagationStoppedImmediately=!0},Event.prototype.isDefaultPrevented=function(){return this._isDefaultPrevented},Event.prototype.preventDefault=function(){this._isDefaultPrevented=!0},Event}()})).call(this)},"events/EventDispatcher":function(a,b,c){((function(){var EventDispatcher,EventPhase,Klass,a=Object.prototype.hasOwnProperty,d=function(b,c){function e(){this.constructor=b}for(var d in c)a.call(c,d)&&(b[d]=c[d]);return e.prototype=c.prototype,b.prototype=new e,b.__super__=c.prototype,b};Klass=b("core/Klass"),EventPhase=b("events/EventPhase"),c.exports=EventDispatcher=function(){function EventDispatcher(){this._events={}}return d(EventDispatcher,Klass),EventDispatcher.prototype.addEventListener=function(a,b,c,d){c==null&&(c=!1),d==null&&(d=0);if(typeof b!="function")throw new TypeError("listener isn't function");return this._events[a]==null&&(this._events[a]=[]),this._events[a].push({listener:b,useCapture:c,priority:d}),this._events[a].sort(this._sortOnPriorityInDescendingOrder),this},EventDispatcher.prototype._sortOnPriorityInDescendingOrder=function(a,b){return b.priority-a.priority},EventDispatcher.prototype.addListener=EventDispatcher.addEventListener,EventDispatcher.prototype.on=EventDispatcher.addEventListener,EventDispatcher.prototype.removeEventListener=function(a,b){var c,d;if(d=this._events[a]){c=d.length;while(c--)d[c].listener===b&&d.splice(c,1);d.length===0&&delete this._events[a]}return this},EventDispatcher.prototype.dispatchEvent=function(a){var b,c,d,e;a.currentTarget=this,d=this._events[a.type];if(d!=null)for(b=0,e=d.length;b<e;b++){c=d[b];if(c.useCapture&&a.eventPhase===EventPhase.CAPTURING_PHASE||c.useCapture===!1&&a.eventPhase!==EventPhase.CAPTURING_PHASE){(function(a,b){return setTimeout(function(){return a.listener(b)},0)})(c,a);if(a._isPropagationStoppedImmediately)break}}return!a._isDefaultPrevented},EventDispatcher.prototype.emit=EventDispatcher.dispatchEvent,EventDispatcher}()})).call(this)},"events/EventPhase":function(a,b,c){((function(){var EventPhase;c.exports=EventPhase={CAPTURING_PHASE:1,AT_TARGET:2,BUBBLING_PHASE:3}})).call(this)},"events/KeyboardEvent":function(a,b,c){((function(){var Event,KeyboardEvent,a=Object.prototype.hasOwnProperty,d=function(b,c){function e(){this.constructor=b}for(var d in c)a.call(c,d)&&(b[d]=c[d]);return e.prototype=c.prototype,b.prototype=new e,b.__super__=c.prototype,b};Event=b("events/Event"),c.exports=KeyboardEvent=function(){function KeyboardEvent(a,b,c,d,e,f,g,h,i,j,k){this.type=a,this.bubbles=b!=null?b:!1,this.cancelable=c!=null?c:!1,d==null&&(d=0),e==null&&(e=0),f==null&&(f=0),g==null&&(g=!1),h==null&&(h=!1),i==null&&(i=!1),j==null&&(j=!1),k==null&&(k=!1),KeyboardEvent.__super__.constructor.call(this,"Event")}return d(KeyboardEvent,Event),KeyboardEvent}()})).call(this)},"events/MouseEvent":function(a,b,c){((function(){var Event,MouseEvent,a=Object.prototype.hasOwnProperty,d=function(b,c){function e(){this.constructor=b}for(var d in c)a.call(c,d)&&(b[d]=c[d]);return e.prototype=c.prototype,b.prototype=new e,b.__super__=c.prototype,b};Event=b("events/Event"),c.exports=MouseEvent=function(){function MouseEvent(a,b,c,d,e,f,g,h,i,j,k,l,m,n){b==null&&(b=!1),c==null&&(c=!1),this.localX=d!=null?d:NaN,this.localY=e!=null?e:NaN,this.relatedObject=f!=null?f:null,g==null&&(g=!1),h==null&&(h=!1),i==null&&(i=!1),j==null&&(j=!1),k==null&&(k=0),l==null&&(l=!1),m==null&&(m=!1),n==null&&(n=0),MouseEvent.__super__.constructor.call(this,a,b,c)}return d(MouseEvent,Event),MouseEvent.CLICK="click",MouseEvent.CONTEXT_MENU="contextMenu",MouseEvent.DOUBLE_CLICK="doubleClick",MouseEvent.MIDDLE_CLICK="middleClick",MouseEvent.MIDDLE_MOUSE_DOWN="middleMouseDown",MouseEvent.MIDDLE_MOUSE_UP="middleMouseUp",MouseEvent.MOUSE_DOWN="mouseDown",MouseEvent.MOUSE_MOVE="mouseMove",MouseEvent.MOUSE_OUT="mouseOut",MouseEvent.MOUSE_OVER="mouseOver",MouseEvent.MOUSE_UP="mouseUp",MouseEvent.MOUSE_WHEEL="mouseWheel",MouseEvent.RIGHT_CLICK="rightClick",MouseEvent.RIGHT_MOUSE_DOWN="rightMouseDown",MouseEvent.RIGHT_MOUSE_UP="rightMouseUp",MouseEvent.ROLL_OUT="rollOut",MouseEvent.ROLL_OVER="rollOver",MouseEvent.prototype.clone=function(){var a;return a=new MouseEvent(this.type,this.bubbles,this.cancelable,this.localX,this.localY,this.relatedObject,this.ctrlKey,this.altKey,this.shiftKey,this.buttonDown,this.delta,this.commandKey,this.controlKey,this.clickCount),a.currentTarget=this.currentTarget,a.target=this.target,a.stageX=this.stageX,a.stageY=this.stageY,a},MouseEvent}()})).call(this)},"filters/BilateralFilter":function(a,b,c){((function(){var BilateralFilter,KernelFilter,a=Object.prototype.hasOwnProperty,d=function(b,c){function e(){this.constructor=b}for(var d in c)a.call(c,d)&&(b[d]=c[d]);return e.prototype=c.prototype,b.prototype=new e,b.__super__=c.prototype,b};KernelFilter=b("filters/KernelFilter"),c.exports=BilateralFilter=function(){function BilateralFilter(a,b,c,d){var e,f,g,h,i,j,k,l;c==null&&(c=1),d==null&&(d=1),h=[],i=2*c*c;for(f=j=1-b;f<b;f+=1)for(e=k=1-a;e<a;e+=1)h.push(Math.exp(-(e*e+f*f)/i));BilateralFilter.__super__.constructor.call(this,a,b,h),this.colorWeightMap=[],i=2*d*d;for(g=0,l=765;g<l;g+=1)this.colorWeightMap[g]=Math.exp(-g*g*i)}return d(BilateralFilter,KernelFilter),BilateralFilter.prototype._runKernel=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v;p=b[d+this.radiusY-1][c+this.radiusX-1],l=p[0],k=p[1],j=p[2],q=m=i=0,t=0,n=this.radiusY*2-1,u=this.radiusX*2-1,o=0;for(s=0;s<n;s+=1){h=d+s;for(r=0;r<u;r+=1)g=c+r,p=b[h][g],v=a[o]*this.colorWeightMap[Math.abs(p[0]-l)+Math.abs(p[1]-k)+Math.abs(p[2]-j)],t+=v,q+=p[0]*v,m+=p[1]*v,i+=p[2]*v,o++}return[q/t,m/t,i/t]},BilateralFilter}()})).call(this)},"filters/BlurFilter":function(a,b,c){((function(){var BlurFilter,KernelFilter,a=Object.prototype.hasOwnProperty,d=function(b,c){function e(){this.constructor=b}for(var d in c)a.call(c,d)&&(b[d]=c[d]);return e.prototype=c.prototype,b.prototype=new e,b.__super__=c.prototype,b};KernelFilter=b("filters/KernelFilter"),c.exports=BlurFilter=function(){function BlurFilter(a,b){var c,d,e,f;f=a*2-1,e=f*f,c=1/e,d=[];while(e--)d.push(c);BlurFilter.__super__.constructor.call(this,a,b,d)}return d(BlurFilter,KernelFilter),BlurFilter}()})).call(this)},"filters/ColorMatrixFilter":function(a,b,c){((function(){var ColorMatrixFilter;c.exports=ColorMatrixFilter=function(){function ColorMatrixFilter(a){this.matrix=a}return ColorMatrixFilter.prototype.scan=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n;i=this.matrix,l=a.width,g=a.height,k=a.data,e=b.data;for(n=0;n<g;n+=1)for(m=0;m<l;m+=1)h=4*(l*n+m),j=k[h],f=k[h+1],d=k[h+2],c=k[h+3],e[h]=j*i[0]+f*i[1]+d*i[2]+c*i[3]+i[4],e[h+1]=j*i[5]+f*i[6]+d*i[7]+c*i[8]+i[9],e[h+2]=j*i[10]+f*i[11]+d*i[12]+c*i[13]+i[14],e[h+3]=j*i[15]+f*i[16]+d*i[17]+c*i[18]+i[19];return b},ColorMatrixFilter}()})).call(this)},"filters/DeficiencyType":function(a,b,c){c.exports=DeficiencyType({PROTANOPIA:"protanopia",PROTANOMALY:"protanomaly",DEUTERANOPIA:"deuteranopia",DEUTERNOMALY:"deuteranomaly",TRITANOPIA:"tritanopia",TRITANOMALY:"tritanomaly",ACHROMATOSIA:"achromatopsia",ACHROMATOMALY:"achromatomaly"})},"filters/DoubleFilter":function(a,b,c){((function(){var DoubleFilter,KernelFilter,a=Object.prototype.hasOwnProperty,d=function(b,c){function e(){this.constructor=b}for(var d in c)a.call(c,d)&&(b[d]=c[d]);return e.prototype=c.prototype,b.prototype=new e,b.__super__=c.prototype,b};KernelFilter=b("filters/KernelFilter"),c.exports=DoubleFilter=function(){function DoubleFilter(){DoubleFilter.__super__.constructor.apply(this,arguments)}return d(DoubleFilter,KernelFilter),DoubleFilter.prototype._evaluatePixel=function(a,b,c,d,e){var f,g,h,i,j,k,l,m;k=g=f=0,h=this.radiusY*2-1,l=this.radiusX*2-1;for(i=0,m=this.kernel.length;0<=m?i<m:i>m;0<=m?i++:i--)j=this._runKernel(this.kernel[i],a,b,c,d,e),k+=j[0]*j[0],g+=j[1]*j[1],f+=j[2]*j[2];return k=Math.sqrt(k),g=Math.sqrt(g),f=Math.sqrt(f),[k,g,f,a[c+this.radiusY-1][b+this.radiusX-1][3]]},DoubleFilter}()})).call(this)},"filters/Filter":function(a,b,c){((function(){var Filter;c.exports=Filter=function(){function Filter(){}return Filter.prototype.scan=function(a){var b,c,d;return d=a.getImageData(),c=this._getPixels(d),b=a.createImageData(),this._setPixels(b,c),b},Filter.prototype._getPixels=function(a){var b,c,d,e,f,g,h;b=a.data,f=a.width,c=a.height,e=[],d=0;for(h=0;h<c;h+=1){e[h]=[];for(g=0;g<f;g+=1)e[h][g]=[b[d],b[d+1],b[d+2],b[d+3]],d+=4}return e},Filter.prototype._setPixels=function(a,b){var c,d,e,f,g,h,i;c=a.data,g=a.width,d=a.height,e=0;for(i=0;i<d;i+=1)for(h=0;h<g;h+=1)f=this._evaluatePixel(b,h,i,g,d),c[e]=f[0],c[e+1]=f[1],c[e+2]=f[2],c[e+3]=f[3],e+=4},Filter.prototype._evaluatePixel=function(a,b,c,d,e){return a[c][b]},Filter}()})).call(this)},"filters/GaussianFilter":function(a,b,c){((function(){var GaussianFilter,KernelFilter,a=Object.prototype.hasOwnProperty,d=function(b,c){function e(){this.constructor=b}for(var d in c)a.call(c,d)&&(b[d]=c[d]);return e.prototype=c.prototype,b.prototype=new e,b.__super__=c.prototype,b};KernelFilter=b("filters/KernelFilter"),c.exports=GaussianFilter=function(){function GaussianFilter(a,b,c){var d,e,f,g,h,i,j,k,l,m;c==null&&(c=1),h=2*c*c,j=0,g=[];for(e=k=1-b;e<b;e+=1)for(d=l=1-a;d<a;d+=1)i=1/(h*Math.PI)*Math.exp(-(d*d+e*e)/h),j+=i,g.push(i);for(f=0,m=g.length;f<m;f+=1)g[f]/=j;GaussianFilter.__super__.constructor.call(this,a,b,g)}return d(GaussianFilter,KernelFilter),GaussianFilter}()})).call(this)},"filters/KernelFilter":function(a,b,c){((function(){var Filter,KernelFilter,a=Object.prototype.hasOwnProperty,d=function(b,c){function e(){this.constructor=b}for(var d in c)a.call(c,d)&&(b[d]=c[d]);return e.prototype=c.prototype,b.prototype=new e,b.__super__=c.prototype,b};Filter=b("filters/Filter"),c.exports=KernelFilter=function(){function KernelFilter(a,b,c){this.radiusX=a,this.radiusY=b,this.kernel=c}return d(KernelFilter,Filter),KernelFilter.prototype.scan=function(a,b){var c,d,e,f,g,h;c=this._getPixels(a);for(e=0,f=this.radiusY-1;e<f;e+=1)c.unshift(c[0].concat()),c.push(c[c.length-1].concat());for(e=0,g=c.length;e<g;e+=1)for(d=0,h=this.radiusX-1;d<h;d+=1)c[e].unshift(c[e][0].concat()),c[e].push(c[e][c[e].length-1].concat());return this._setPixels(b,c),b},KernelFilter.prototype._evaluatePixel=function(a,b,c,d,e){var f;return f=this._runKernel(this.kernel,a,b,c,d,e),f[3]=a[c+this.radiusY-1][b+this.radiusX-1][3],f},KernelFilter.prototype._runKernel=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q,r;o=k=i=0,l=this.radiusY*2-1,r=this.radiusX*2-1,m=0;for(q=0;q<l;q+=1){h=d+q;for(p=0;p<r;p+=1)g=c+p,n=b[h][g],j=a[m],o+=n[0]*j,k+=n[1]*j,i+=n[2]*j,m++}return[o,k,i]},KernelFilter}()})).call(this)},"filters/LaplacianFilter":function(a,b,c){((function(){var KernelFilter,LaplacianFilter,a,d,e=Object.prototype.hasOwnProperty,f=function(a,b){function d(){this.constructor=a}for(var c in b)e.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};KernelFilter=b("filters/KernelFilter"),a=[0,1,0,1,-4,1,0,1,0],d=[1,1,1,1,-8,1,1,1,1],c.exports=LaplacianFilter=function(){function LaplacianFilter(b){b==null&&(b=!1),LaplacianFilter.__super__.constructor.call(this,2,2,b?d:a)}return f(LaplacianFilter,KernelFilter),LaplacianFilter}()})).call(this)},"filters/MedianFilter":function(a,b,c){((function(){var KernelFilter,MedianFilter,a=Object.prototype.hasOwnProperty,d=function(b,c){function e(){this.constructor=b}for(var d in c)a.call(c,d)&&(b[d]=c[d]);return e.prototype=c.prototype,b.prototype=new e,b.__super__=c.prototype,b};KernelFilter=b("filters/KernelFilter"),c.exports=MedianFilter=function(){function MedianFilter(){MedianFilter.__super__.constructor.apply(this,arguments)}return d(MedianFilter,KernelFilter),MedianFilter.prototype._runKernel=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n;k=[],i=this.radiusY*2-1,n=this.radiusX*2-1,j=0;for(m=0;m<i;m+=1){h=d+m;for(l=0;l<n;l+=1)g=c+l,k[j]=b[h][g],j++}return k.sort(this._sortAsSum),k[j>>1]},MedianFilter.prototype._sortAsSum=function(a,b){var c,d,e;d=e=0;for(c=0;c<3;c+=1)d+=a[c],e+=b[c];return d-e},MedianFilter}()})).call(this)},"filters/PrewittFilter":function(a,b,c){((function(){var DoubleFilter,PrewittFilter,a,d=Object.prototype.hasOwnProperty,e=function(a,b){function e(){this.constructor=a}for(var c in b)d.call(b,c)&&(a[c]=b[c]);return e.prototype=b.prototype,a.prototype=new e,a.__super__=b.prototype,a};DoubleFilter=b("filters/DoubleFilter"),a=[[-1,0,1,-1,0,1,-1,0,1],[-1,-1,-1,0,0,0,1,1,1]],c.exports=PrewittFilter=function(){function PrewittFilter(){PrewittFilter.__super__.constructor.call(this,2,2,a)}return e(PrewittFilter,DoubleFilter),PrewittFilter}()})).call(this)},"filters/SobelFilter":function(a,b,c){((function(){var DoubleFilter,SobelFilter,a,d=Object.prototype.hasOwnProperty,e=function(a,b){function e(){this.constructor=a}for(var c in b)d.call(b,c)&&(a[c]=b[c]);return e.prototype=b.prototype,a.prototype=new e,a.__super__=b.prototype,a};DoubleFilter=b("filters/DoubleFilter"),a=[[-1,0,1,-2,0,2,-1,0,1],[-1,-2,-1,0,0,0,1,2,1]],c.exports=SobelFilter=function(){function SobelFilter(){SobelFilter.__super__.constructor.call(this,2,2,a)}return e(SobelFilter,DoubleFilter),SobelFilter}()})).call(this)},"filters/UnsharpMaskFilter":function(a,b,c){((function(){var KernelFilter,UnsharpMaskFilter,a=Object.prototype.hasOwnProperty,d=function(b,c){function e(){this.constructor=b}for(var d in c)a.call(c,d)&&(b[d]=c[d]);return e.prototype=c.prototype,b.prototype=new e,b.__super__=c.prototype,b};KernelFilter=b("filters/KernelFilter"),c.exports=UnsharpMaskFilter=function(){function UnsharpMaskFilter(a,b,c){var d,e,f,g,h;this.amount=c!=null?c:1,h=a*2-1,g=d=h*h,e=1/g,f=[];while(d--)f.push(-e);f[g>>1]=1+(1-e)*this.amount,UnsharpMaskFilter.__super__.constructor.call(this,a,b,f)}return d(UnsharpMaskFilter,KernelFilter),UnsharpMaskFilter}()})).call(this)},"geom/ColorMatrix":function(a,b,c){((function(){var ColorMatrix,StringUtil,a,d,e,f,g,h,i,j,k;StringUtil=b("utils/StringUtil"),h=.212671,f=.71516,d=.072169,i=.3086,g=.6094,e=.082,j=1/3,a=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],k=Math.PI/180,c.exports=ColorMatrix=function(){function ColorMatrix(a){a instanceof ColorMatrix?this.matrix=a.matrix.concat():Array.isArray(a)?this.matrix=a.concat():this.reset()}return ColorMatrix.prototype.toString=function(){var a,b,c,d,e,f,g,h,i,j,k,l;d=[],i=this.matrix;for(a=0,h=i.length;a<h;a++)e=i[a],a%5===0&&(c=[]),c.push(String(e)),(a%5===4||a===this.matrix.length-1)&&d.push(c);for(f=0;f<5;f++){b=0;for(g=0,j=d.length;g<j;g+=1)b=Math.max(b,d[g][f].length);for(g=0,k=d.length;g<k;g+=1)d[g][f]=StringUtil.padLeft(d[g][f],b)}for(g=0,l=d.length;g<l;g+=1)d[g]=d[g].join(", "),g!==d.length-1&&(d[g]+=",");return d.join("\n")},ColorMatrix.prototype.clone=function(){return new ColorMatrix(this.matrix)},ColorMatrix.prototype.reset=function(){return this.matrix=a.concat()},ColorMatrix.prototype.concat=function(a){var b,c,d,e,f;b=this.matrix,d=[];for(f=0;f<4;f++){c=5*f;for(e=0;e<5;e++)d[c+e]=a[c]*b[e]+a[c+1]*b[e+5]+a[c+2]*b[e+10]+a[c+3]*b[e+15];d[c+4]+=a[c+4]}return this.matrix=d},ColorMatrix.prototype.invert=function(){return this.concat([-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0])},ColorMatrix.prototype.adjustSaturation=function(a){var b,c,e;return e=-a*h,c=-a*f,b=-a*d,++a,this.concat([e+a,c,b,0,0,e,c+a,b,0,0,e,c,b+a,0,0,0,0,0,1,0])},ColorMatrix.prototype.adjustContrast=function(a,b,c){return b==null&&(b=a),c==null&&(c=a),this.concat([1+a,0,0,0,-128*a,0,1+b,0,0,-128*b,0,0,1+c,0,-128*c,0,0,0,1,0])},ColorMatrix.prototype.adjustBrightness=function(a,b,c){return b==null&&(b=a),c==null&&(c=a),this.concat([1,0,0,0,255*a,0,1,0,0,255*b,0,0,1,0,255*c,0,0,0,1,0])},ColorMatrix.prototype.adjustHue=function(a){var b,c,e,g,i,j,l,m;return e=h,c=f,b=d,a*=k,g=Math.cos(a),m=Math.sin(a),i=1-g,j=i-m,l=i+m,this.concat([e*j+g,c*j,b*j+m,0,0,e*i+m*.143,c*i+g+m*.14,b*i+m*-0.283,0,0,e*l-m,c*l,b*l+g,0,0,0,0,0,1,0])},ColorMatrix.prototype.rotateHue=function(a){return this._initHue(),this.concat(this._preHue.matrix),this.rotateBlue(a),this.concat(this._postHue.matrix)},ColorMatrix.prototype.luminance2Alpha=function(){return this.concat([0,0,0,0,255,0,0,0,0,255,0,0,0,0,255,h,f,d,0,0])},ColorMatrix.prototype.adjustAlphaContrast=function(a){return this.concat([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,a+1,-128*a])},ColorMatrix.prototype.colorize=function(a,b){var c,e,g,i,j,k,l;return b==null&&(b=1),g=h,e=f,c=d,l=(a>>16&255)/255,j=(a>>8&255)/255,i=(a&255)/255,k=1-b,this.concat([k+b*l*g,b*l*e,b*l*c,0,0,b*j*g,k+b*j*e,b*j*c,0,0,b*i*g,b*i*e,k+b*i*c,0,0,0,0,0,1,0])},ColorMatrix.prototype.setChannels=function(a,b,c,d){var e,f,g,h;return a==null&&(a=1),b==null&&(b=2),c==null&&(c=4),d==null&&(d=8),h=((a&1)===1?1:0)+((a&2)===2?1:0)+((a&4)===4?1:0)+((a&8)===8?1:0),h>0&&(h=1/h),g=((b&1)===1?1:0)+((b&2)===2?1:0)+((b&4)===4?1:0)+((b&8)===8?1:0),g>0&&(g=1/g),f=((c&1)===1?1:0)+((c&2)===2?1:0)+((c&4)===4?1:0)+((c&8)===8?1:0),f>0&&(f=1/f),e=((d&1)===1?1:0)+((d&2)===2?1:0)+((d&4)===4?1:0)+((d&8)===8?1:0),e>0&&(e=1/e),this.concat([(a&1)===1?h:0,(a&2)===2?h:0,(a&4)===4?h:0,(a&8)===8?h:0,0,(b&1)===1?g:0,(b&2)===2?g:0,(b&4)===4?g:0,(b&8)===8?g:0,0,(c&1)===1?f:0,(c&2)===2?f:0,(c&4)===4?f:0,(c&8)===8?f:0,0,(d&1)===1?e:0,(d&2)===2?e:0,(d&4)===4?e:0,(d&8)===8?e:0,0])},ColorMatrix.prototype.blend=function(a,b){var c,d,e,f,g;f=a.matrix,g=[];for(c=0,e=f.length;c<e;c++)d=f[c],g.push(this.matrix[c]=this.matrix[c]*(1-b)+d*b);return g},ColorMatrix.prototype.average=function(a,b,c){return a==null&&(a=j),b==null&&(b=j),c==null&&(c=j),this.concat([a,b,c,0,0,a,b,c,0,0,a,b,c,0,0,0,0,0,1,0])},ColorMatrix.prototype.threshold=function(a,b){var c,e,g,i;return b==null&&(b=256),g=b*h,e=b*f,c=b*d,i=-b*a,this.concat([g,e,c,0,i,g,e,c,0,i,g,e,c,0,i,0,0,0,1,0])},ColorMatrix.prototype.desaturate=function(){var a,b,c;return c=h,b=f,a=d,this.concat([c,b,a,0,0,c,b,a,0,0,c,b,a,0,0,0,0,0,1,0])},ColorMatrix.prototype.randomize=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n;return a==null&&(a=1),h=1-a,l=h+a*(Math.random()-Math.random()),e=a*(Math.random()-Math.random()),b=a*(Math.random()-Math.random()),i=a*255*(Math.random()-Math.random()),m=a*(Math.random()-Math.random()),f=h+a*(Math.random()-Math.random()),c=a*(Math.random()-Math.random()),j=a*255*(Math.random()-Math.random()),n=a*(Math.random()-Math.random()),g=a*(Math.random()-Math.random()),d=h+a*(Math.random()-Math.random()),k=a*255*(Math.random()-Math.random()),this.concat([l,e,b,0,i,m,f,c,0,j,n,g,d,0,k,0,0,0,1,0])},ColorMatrix.prototype.setMultiplicators=function(a,b,c,d){return a==null&&(a=1),b==null&&(b=1),c==null&&(c=1),d==null&&(d=1),this.concat([a,0,0,0,0,0,b,0,0,0,0,0,c,0,0,0,0,0,d,0])},ColorMatrix.prototype.clearChannels=function(a,b,c,d){a==null&&(a=!1),b==null&&(b=!1),c==null&&(c=!1),d==null&&(d=!1),a&&(this.matrix[0]=this.matrix[1]=this.matrix[2]=this.matrix[3]=this.matrix[4]=0),b&&(this.matrix[5]=this.matrix[6]=this.matrix[7]=this.matrix[8]=this.matrix[9]=0),c&&(this.matrix[10]=this.matrix[11]=this.matrix[12]=this.matrix[13]=this.matrix[14]=0);if(d)return this.matrix[15]=this.matrix[16]=this.matrix[17]=this.matrix[18]=this.matrix[19]=0},ColorMatrix.prototype.thresholdAlpha=function(a,b){return b==null&&(b=256),this.concat([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,b,-b*a])},ColorMatrix.prototype.averageRGB2Alpha=function(){return this.concat([0,0,0,0,255,0,0,0,0,255,0,0,0,0,255,j,j,j,0,0])},ColorMatrix.prototype.invertAlpha=function(){return this.concat([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,-1,255])},ColorMatrix.prototype.rgb2Alpha=function(a,b,c){return this.concat([0,0,0,0,255,0,0,0,0,255,0,0,0,0,255,a,b,c,0,0])},ColorMatrix.prototype.setAlpha=function(a){return this.concat([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,a,0])},ColorMatrix.prototype.rotateRed=function(a){return this._rotateColor(a,2,1)},ColorMatrix.prototype.rotateGreen=function(a){return this._rotateColor(a,0,2)},ColorMatrix.prototype.rotateBlue=function(a){return this._rotateColor(a,1,0)},ColorMatrix.prototype._rotateColor=function(b,c,d){var e;return b*=k,e=a.concat(),e[c+c*5]=e[d+d*5]=Math.cos(b),e[d+c*5]=Math.sin(b),e[c+d*5]=-Math.sin(b),this.concat(e)},ColorMatrix.prototype.shearRed=function(a,b){return this._shearColor(0,1,a,2,b)},ColorMatrix.prototype.shearGreen=function(a,b){return this._shearColor(1,0,a,2,b)},ColorMatrix.prototype.shearBlue=function(a,b){return this._shearColor(2,0,a,1,b)},ColorMatrix.prototype._shearColor=function(b,c,d,e,f){var g;return g=a.concat(),g[c+b*5]=d,g[e+b*5]=f,this.concat(g)},ColorMatrix.prototype.applyColorDeficiency=function(a){switch(a){case"Protanopia":this.concat([.567,.433,0,0,0,.558,.442,0,0,0,0,.242,.758,0,0,0,0,0,1,0]);break;case"Protanomaly":this.concat([.817,.183,0,0,0,.333,.667,0,0,0,0,.125,.875,0,0,0,0,0,1,0]);break;case"Deuteranopia":this.concat([.625,.375,0,0,0,.7,.3,0,0,0,0,.3,.7,0,0,0,0,0,1,0]);break;case"Deuteranomaly":this.concat([.8,.2,0,0,0,.258,.742,0,0,0,0,.142,.858,0,0,0,0,0,1,0]);break;case"Tritanopia":this.concat([.95,.05,0,0,0,0,.433,.567,0,0,0,.475,.525,0,0,0,0,0,1,0]);break;case"Tritanomaly":this.concat([.967,.033,0,0,0,0,.733,.267,0,0,0,.183,.817,0,0,0,0,0,1,0]);break;case"Achromatopsia":this.concat([.299,.587,.114,0,0,.299,.587,.114,0,0,.299,.587,.114,0,0,0,0,0,1,0]);break;case"Achromatomaly":this.concat([.618,.32,.062,0,0,.163,.775,.062,0,0,.163,.32,.516,0,0,0,0,0,1,0])}},ColorMatrix.prototype.applyMatrix=function(a){var b,c,d,e,f,g,h,i,j;return b=a>>>24&255,i=a>>>16&255,f=a>>>8&255,d=a&255,h=this.matrix,j=.5+i*h[0]+f*h[1]+d*h[2]+b*h[3]+h[4],g=.5+i*h[5]+f*h[6]+d*h[7]+b*h[8]+h[9],e=.5+i*h[10]+f*h[11]+d*h[12]+b*h[13]+h[14],c=.5+i*h[15]+f*h[16]+d*h[17]+b*h[18]+h[19],c<0&&(c=0),c>255&&(c=255),j<0&&(j=0),j>255&&(j=255),g<0&&(g=0),g>255&&(g=255),e<0&&(e=0),e>255&&(e=255),c<<24|j<<16|g<<8|e},ColorMatrix.prototype.transformVector=function(a){var b,c,d,e,f,g,h,i,j;if(a.length!==4)throw new TypeError("values length isn't 4");return b=this.matrix,j=a[0],i=a[1],h=a[2],g=a[3],f=j*b[0]+i*b[1]+h*b[2]+g*b[3]+b[4],e=j*b[5]+i*b[6]+h*b[7]+g*b[8]+b[9],d=j*b[10]+i*b[11]+h*b[12]+g*b[13]+b[14],c=j*b[15]+i*b[16]+h*b[17]+g*b[18]+b[19],a[0]=f,a[1]=e,a[2]=d,a[3]=c},ColorMatrix.prototype._initHue=function(){var a,b,c,d;b=39.182655;if(!this._hueInitialized)return this._hueInitialized=!0,this._preHue=new ColorMatrix,this._preHue.rotateRed(45),this._preHue.rotateGreen(-b),c=[i,g,e,1],this._preHue.transformVector(c),d=c[0]/c[2],a=c[1]/c[2],this._preHue.shearBlue(d,a),this._postHue=new ColorMatrix,this._postHue.shearBlue(-d,-a),this._postHue.rotateGreen(b),this._postHue.rotateRed(-45)},ColorMatrix}()})).call(this)},"geom/Matrix":function(a,b,c){((function(){var Matrix,StringUtil,Vector,a,d,e;Vector=b("geom/Vector"),StringUtil=b("utils/StringUtil"),d=Math.sin,a=Math.cos,e=Math.tan,c.exports=Matrix=function(){function Matrix(a,b,c,d,e,f){this.xx=a!=null?a:1,this.xy=b!=null?b:0,this.yx=c!=null?c:0,this.yy=d!=null?d:1,this.ox=e!=null?e:0,this.oy=f!=null?f:0}return Matrix.prototype.identity=function(){return this.xx=1,this.xy=0,this.yx=0,this.yy=1,this.ox=0,this.oy=0},Matrix.prototype.clone=function(){return new Matrix(this.xx,this.xy,this.yx,this.yy,this.ox,this.oy)},Matrix.prototype.toString=function(){return""+this.xx+" "+this.yx+" "+this.ox+"\n"+this.xy+" "+this.yy+" "+this.oy+"\n0 0 1"},Matrix.prototype.apply=function(a){return this._apply(a.xx,a.xy,a.yx,a.yy,a.ox,a.oy)},Matrix.prototype._apply=function(a,b,c,d,e,f){return this.xx=a,this.xy=b,this.yx=c,this.yy=d,this.ox=e,this.oy=f,this},Matrix.prototype.setTo=function(a){return a.setTransform(this.xx,this.xy,this.yx,this.yy,this.ox,this.oy)},Matrix.prototype.concat=function(a){return this._concat(a.xx,a.xy,a.yx,a.yy,a.ox,a.oy)},Matrix.prototype._concat=function(a,b,c,d,e,f){var g,h,i,j,k,l;return i=this.xx,j=this.xy,k=this.yx,l=this.yy,g=this.ox,h=this.oy,this.xx=a*i+c*j,this.xy=b*i+d*j,this.yx=a*k+c*l,this.yy=b*k+d*l,this.ox=a*g+c*h+e,this.oy=b*g+d*h+f,this},Matrix.prototype.translate=function(a,b){return this._concat(1,0,0,1,a,b)},Matrix.prototype.scale=function(a,b){return this._concat(a,0,0,b,0,0)},Matrix.prototype.rotate=function(b){var c,e;return c=a(b),e=d(b),this._concat(c,e,-e,c,0,0)},Matrix.prototype.skew=function(a,b){return this._concat(0,e(b),e(a),0,0,0)},Matrix.prototype.invert=function(){var a,b,c,d,e,f,g;return d=this.xx,e=this.xy,f=this.yx,g=this.yy,b=this.ox,c=this.oy,a=d*g-e*f,this.xx=g/a,this.xy=-e/a,this.yx=-f/a,this.yy=d/a,this.ox=(f*c-g*b)/a,this.oy=(e*b-d*c)/a,this},Matrix.prototype.transformPoint=function(a){return new Vector(this.xx*a.x+this.yx*a.y+this.ox,this.xy*a.x+this.yy*a.y+this.oy)},Matrix.prototype.deltaTransformPoint=function(a){return new Vector(this.xx*a.x+this.yx*a.y,this.xy*a.x+this.yy*a.y)},Matrix.prototype.createBox=function(b,c,e,f,g){var h,i;return e==null&&(e=0),f==null&&(f=0),g==null&&(g=0),h=a(e),i=d(e),this._concat(b*h,c*i,-b*i,c*h,f,g)},Matrix.prototype.createGradientBox=function(a,b,c,d,e){return c==null&&(c=0),d==null&&(d=0),e==null&&(e=0),this.createBox(a/1638.4,b/1638.4,c,d+a/2,e+b/2)},Matrix}()})).call(this)},"geom/Quadtree":function(a,b,c){((function(){var Quadtree,StringUtil,a,d,e;StringUtil=b("utils/StringUtil"),d=Math.pow,a=StringUtil.padLeft,e=function(a){return a=(a|a<<8)&16711935,a=(a|a<<4)&252645135,a=(a|a<<2)&858993459,(a|a<<1)&1431655765},c.exports=Quadtree=function(){function Quadtree(a){a==null&&(a=3),this._level=a,this._sides=d(2,this._level),this._spaces=this._sides*this._sides,this._bits=(this._spaces-1).toString(2).length}return Quadtree.coordToZOrder=function(a,b){return e(a)|e(b)<<1},Quadtree.prototype.coordsToIndex=function(a,b,c,e){var f,g,h,i,j,k;i=Quadtree.coordToZOrder(a,b),j=Quadtree.coordToZOrder(c,e),h=i^j,g=this._bits/2;for(f=0;0<=g?f<g:f>g;0<=g?f++:f--){if((h&3<<2*(g-f-1))===0)continue;k=2*(g-f);break}return j>>=k,(d(4,f)-1)/3+j},Quadtree.prototype.toBitString=function(b){return a(b.toString(2),this._bits,"0")},Quadtree}()})).call(this)},"geom/QuadtreeSpace":function(a,b,c){((function(){var Quadtree,QuadtreeSpace,Rectangle;Quadtree=b("geom/Quadtree"),Rectangle=b("geom/Rectangle"),c.exports=QuadtreeSpace=function(){function QuadtreeSpace(a,c,d){var Shape,TextField,TextFormat,e,f,g,h,i,j,k,l;this.rectangle=a,this.debusSprite=d!=null?d:null,this.quadtree=new Quadtree(c),this._widthPerSide=this.rectangle.width/this.quadtree._sides,this._heightPerSide=this.rectangle.height/this.quadtree._sides,this._storage=[],this.debugSprite&&(Shape=b("display/Shape"),TextField=b("display/TextField"),TextFormat=b("display/styles/TextFormat"),e=(new Sprite).addTo(this.debugSprite),g=(new Shape).addTo(e),f=new TextFormat("monospace",12,!1,!1,!1,"center","middle"));for(i=0,k=this.quadtree._sides;i<k;i+=1)for(j=0,l=this.quadtree._sides;j<l;j+=1)g.drawRect(this._widthPerSide*i,this._heightPerSide*j,this._widthPerSide,this._heightPerSide),h=new TextField(Quadtree.coordToZOrder(i,j),f),h.x=this._widthPerSide*(i+.5),h.y=this._heightPerSide*(j+.5),h.addTo(e),this._fixedShape=(new Shape).addTo(e),this._floatingShape=(new Shape).addTo(e)}return QuadtreeSpace.prototype.add=function(a,b){b==null&&(b=!1),a.apply(a.intersection(this.rectangle)),this._storage.push({rectangle:a,fixed:b}),this.debugSprite!=null&&b&&(this._fixedShape.drawRect(a.x-this.rectangle.x,a.y-this.rectangle.y,a.width,a.height),this._fixedShape.stroke(1,16711680))},QuadtreeSpace.prototype.remove=function(a){var b;b=this._storage.length;while(b-->0)if(a===this._storage[b].rectangle){this._storage.splice(b,1);break}},QuadtreeSpace.prototype.detectCollision=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p;this.debugSprite!=null&&this._floatingShape.clear(),h=[],p=this._storage;for(n=0,o=p.length;n<o;n++)i=p[n],this._update2DPosition(i),d=this.quadtree.coordsToIndex(i.x0,i.y0,i.x1,i.y1),h[d]!=null&&(h[d]=[]),h[d].push(i),this.debugSprite!=null&&i.fixed===!1&&(l=i.rectangle,this._floatingShape.drawRect(l.x-this.rectangle.x,l.y-this.rectangle.y,l.width,l.height),this._floatingShape.stroke(1,255));a=[],c=h.length;while(c--){j=h[c];if(j!=null){e=j.length;while(e--){m=j[e].rectangle,f=e;while(f--)b=j[f].rectangle,m.intersects(b)&&a.push([m,b]);f=c;while((f=f-1>>2)>=0){k=h[f];if(k!=null){g=k.length;while(g--)b=k[g].rectangle,m.intersects(b)&&a.push([m,b])}}}}}return a},QuadtreeSpace.prototype._update2DPosition=function(a){var b;return b=a.rectangle,a.x0=this._validatePos((b.x-this.rectangle.x)/this._widthPerSide),a.y0=this._validatePos((b.y-this.rectangle.y)/this._heightPerSide),a.x1=this._validatePos((b.x+b.width-this.rectangle.x)/this._widthPerSide),a.y1=this._validatePos((b.y+b.height-this.rectangle.y)/this._heightPerSide),a.x0!==-1&&a.y0!==-1&&a.x1!==-1&&a.y1!==-1},QuadtreeSpace.prototype._validatePos=function(a){return a<0||this.quadtree._sides<a?-1:a===this.quadtree._sides?this.quadtree._sides-1:a>>0},QuadtreeSpace}()})).call(this)},"geom/Rectangle":function(a,b,c){((function(){var Rectangle,a,b,d;b=Math.min,a=Math.max,d=Math.sqrt,c.exports=Rectangle=function(){function Rectangle(a,b,c,d){this.x=a!=null?a:0,this.y=b!=null?b:0,this.width=c!=null?c:0,this.height=d!=null?d:0}return Rectangle.prototype.toString=function(){return"[Rectangle x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},Rectangle.prototype.clone=function(){return new Rectangle(this.x,this.y,this.width,this.height)},Rectangle.prototype.apply=function(a){return this.x=a.x,this.y=a.y,this.width=a.width,this.height=a.height,this},Rectangle.prototype.contains=function(a,b){return this.x<a&&a<this.x+this.width&&this.y<b&&b<this.y+this.height},Rectangle.prototype.containsPoint=function(a){var b,c;return this.x<(b=a.x)&&b<this.x+this.width&&this.y<(c=a.y)&&c<this.y+this.height},Rectangle.prototype.contain=function(a,b){return a<this.x?(this.width+=this.x-a,this.x=a):a>this.x+this.width&&(this.width=a-this.x),b<this.y?(this.height+=this.y-b,this.y=b):b>this.y+this.height&&(this.height=b-this.y),this},Rectangle.prototype.offset=function(a,b){return this.x+=a,this.y+=b,this},Rectangle.prototype.offsetPoint=function(a){return this.x+=a.x,this.y+=a.y,this},Rectangle.prototype.inflate=function(a,b){return this.width+=a,this.height+=b,this},Rectangle.prototype.inflatePoint=function(a){return this.width+=a.x,this.height+=a.y,this},Rectangle.prototype.deflate=function(a,b){return this.width-=a,this.height-=b,this},Rectangle.prototype.deflatePoint=function(a){return this.width-=a.x,this.height-=a.y,this},Rectangle.prototype.union=function(a){var b,c,d,e,f,g,h,i,j,k;return f=this.x<a.x?this.x:a.x,h=this.x+this.width,i=a.x+a.width,g=h>i?h:i,k=g-f,j=this.y<a.y?this.y:a.y,c=this.y+this.height,d=a.y+a.height,b=c>d?c:d,e=b-j,this.x=f,this.y=j,this.width=k<0?0:k,this.height=e<0?0:e,this},Rectangle.prototype.isEmpty=function(){return this.x===0&&this.y===0&&this.width===0&&this.height===0},Rectangle.prototype.intersects=function(c){var d,e,f,g,h,i;return f=a(this.x,c.x),g=b(this.x+this.width,c.x+c.width),i=g-f,i<=0?!1:(h=a(this.y,c.y),d=b(this.y+this.height,c.y+c.height),e=d-h,e<=0?!1:!0)},Rectangle.prototype.intersection=function(c){var d,e,f,g,h,i;return f=a(this.x,c.x),g=b(this.x+this.width,c.x+c.width),i=g-f,i<=0?new Rectangle:(h=a(this.y,c.y),d=b(this.y+this.height,c.y+c.height),e=d-h,e<=0?new Rectangle:new Rectangle(f,h,i,e))},Rectangle.prototype.measureFarDistance=function(b,c){var e,f,g,h,i,j,k,l,m;return j=this.x,l=this.x+this.width,m=this.y,e=this.y+this.height,g=b-j,h=b-l,i=c-m,f=c-e,g*=g,h*=h,i*=i,f*=f,k=a(g+i,h+i,h+f,g+f),d(k)},Rectangle.prototype.adjustOuter=function(){var a,b;return a=Math.floor(this.x),b=Math.floor(this.y),a!==this.x&&this.width++,b!==this.y&&this.height++,this.x=a,this.y=b,this.width=Math.ceil(this.width),this.height=Math.ceil(this.height)},Rectangle}()})).call(this)},"geom/Vector":function(a,b,c){((function(){var Klass,Vector,a,d,e,f,g=Object.prototype.hasOwnProperty,h=function(a,b){function d(){this.constructor=a}for(var c in b)g.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};Klass=b("core/Klass"),e=Math.sin,d=Math.cos,a=Math.atan2,f=Math.sqrt,c.exports=Vector=function(){function Vector(b,c){var g;this.x=b!=null?b:0,this.y=c!=null?c:0,this.x instanceof Vector&&(g=this.x,this.x=g.x,this.y=g.y),this.defineProperty("direction",function(){return a(this.y,this.x)},function(a){var b;b=f(this.x*this.x+this.y*this.y),this.x=b*d(a),this.y=b*e(a)}),this.defineProperty("magnitude",function(){return f(this.x*this.x+this.y*this.y)},function(a){var b;b=a/f(this.x*this.x+this.y*this.y),this.x*=b,this.y*=b})}return h(Vector,Klass),Vector.crossProduct=function(a,b){return a.distance*b.distance*e(b.angle-a.angle)},Vector.dotProduct=function(a,b){},Vector.distance=function(a,b){var c,d;return c=a.x-b.x,d=a.y-b.y,f(c*c+d*d)},Vector.between=function(a,b,c){return c==null&&(c=.5),new Vector(a.x+(b.x-a.x)*c,a.y+(b.y-a.y)*c)},Vector.prototype.add=function(a){return new Vector(this.x+a.x,this.y+a.y)},Vector.prototype.subtract=function(a){return new Vector(this.x-a.x,this.y-a.y)},Vector.prototype.divide=function(a){return new Vector(this.x/a,this.y/a)},Vector.prototype.toString=function(){return"("+this.x+", "+this.y+")"},Vector.prototype.equals=function(a){return this.x===a.x&&this.y===a.y},Vector.prototype.normalize=function(a){var b;return a==null&&(a=1),b=a/f(this.x*this.x+this.y*this.y),this.x*=b,this.y*=b,this},Vector}()})).call(this)},"serialization/DateFormat":function(a,b,c){((function(){var DateFormat,a,d;a=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:\.(\d*))?Z$/,d=b("utils/StringUtil").padLeft,c.exports=DateFormat={stringifyJSON:function(a){return""+a.getUTCFullYear()+"-"+d(a.getUTCMonth()+1,2,"0")+"-"+d(a.getUTCDate(),2,"0")+"T"+d(a.getUTCHours(),2,"0")+":"+d(a.getUTCMinutes(),2,"0")+":"+d(a.getUTCSeconds(),2,"0")+"."+d(a.getUTCMilliseconds(),3,"0")+"Z"},parseJSON:function(b){var c;if(typeof b=="string"){c=a.exec(b);if(c!=null)return new Date(Date.UTC(+c[1],+c[2]-1,+c[3],+c[4],+c[5],+c[6],+c[7]))}return b},reviveJSON:function(a,b){return DateFormat.parseJSON(b)}}})).call(this)},"serialization/JSON":function(exports,require,module){((function(){var DateFormat,JSON,__META,__R_CHARS,__R_CX,__R_ESCAPABLE,__R_RACES,__R_SPACES,__R_TOKENS,__quote,__str,__walk,_base;DateFormat=require("serialization/DateFormat"),__R_ESCAPABLE=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,__META={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},__R_CX=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,__R_CHARS=/^[\],:{}\s]*$/,__R_SPACES=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,__R_TOKENS=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,__R_RACES=/(?:^|:|,)(?:\s*\[)+/g,__quote=function(a){return __R_ESCAPABLE.lastIndex=0,__R_ESCAPABLE.test(a)?'"'+a.replace(__R_ESCAPABLE,function(a){var b;return b=__META[a],typeof b=="string"?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'},__str=function(a,b,c,d,e){var f,g,h,i,j,k,l,m;h=d,k=b[a],k instanceof Date&&(k=DateFormat.stringifyJSON(k)),typeof c=="function"&&(k=c.call(b,a,k));switch(typeof k){case"string":return __quote(k);case"number":return isFinite(k)?String(k):"null";case"boolean":case"null":return String(k);case"object":if(!k)return"null";d+=e,i=[];if(Object.prototype.toString.apply(k)==="[object Array]"){for(f=0,l=k.length;f<l;f+=1)i[f]=__str(f,k,c,d,e)||"null";return j=i.length===0?"[]":d?"[\n"+d+i.join(",\n"+d)+"\n"+h+"]":"["+i.join(",")+"]",d=h,j}if(c&&typeof c=="object")for(f=0,m=c.length;f<m;f+=1)typeof c[f]=="string"&&(g=c[f],j=__str(g,k,c,d,e),j&&i.push(__quote(g)+(d?": ":":")+j));else for(g in k){if(!__hasProp.call(k,g))continue;j=__str(g,k,c,d,e),j&&i.push(__quote(g)+(d?": ":":")+j)}return j=i.length===0?"{}":d?"{\n"+d+i.join(",\n"+d)+"\n"+h+"}":"{"+i.join(",")+"}",d=h,j}},__walk=function(a,b,c){var d,e,f;f=a[b];if(f&&typeof f=="object")for(d in f)e=__walk(f,d,c),e!==void 0?f[d]=e:delete f[d];return c.call(a,b,f)},module.exports=JSON=(typeof (_base=window.JSON).stringify=="function"?_base.stringify([new Date]).charAt(21):void 0)==="."?window.JSON:{stringify:function(a,b,c){var d,e,f,g;e="",g=typeof c;if(g==="number")for(d=0;d<c;d+=1)e+=" ";else g==="string"&&(e=c);if(!b||(f=typeof b)==="function"||f==="object"&&typeof b.length=="number")return __str("",{"":a},b,"",e);throw new Error("JSON.stringify")},parse:function(text,reviver){return text=String(text),__R_CX.lastIndex=0,__R_CX.test(text)&&(text=text.replace(__R_CX,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),__R_CHARS.test(text.replace(__R_SPACES,"@").replace(__R_TOKENS,"]").replace(__R_RACES,""))&&(text=eval("("+text+")")),typeof reviver=="function"&&__walk({"":text},"",reviver),text}}})).call(this)},"serialization/QueryString":function(a,b,c){((function(){var QueryString;c.exports=QueryString={stringify:function(a,b,c){var d,e,f,g,h,i;b==null&&(b="&"),c==null&&(c="="),e=[];for(d in a){g=a[d],d=encodeURIComponent(d);if(Object.prototype.toString.call(g)==="[object Array]")for(h=0,i=g.length;h<i;h++)f=g[h],e.push(f!=null?d+c+encodeURIComponent(f):d);else e.push(g!=null?d+c+encodeURIComponent(g):d)}return e.join(b)},parse:function(a,b,c){var d,e,f,g,h,i,j,k,l;b==null&&(b="&"),c==null&&(c="="),h={},g=a.split(b),l=[];for(j=0,k=g.length;j<k;j++)f=g[j],e=f.split(c),d=e[0],i=e[1],d in h?(d=decodeURIComponent(d),typeof h[d]=="string"&&(h[d]=[h[d]]),l.push(h[d].push(decodeURIComponent(i)))):l.push(h[d]=decodeURIComponent(i));return l}}})).call(this)},"system/Capabilities":function(a,b,c){((function(){var Capabilities,a,b,d,e,f,g,h,i,j,k,l,m,n;a=/(chrome)[ \/]([\w.]+)/,f=/(safari)[ \/]([\w.]+)/,g=/(webkit)[ \/]([\w.]+)/,e=/(opera)(?:.*version)?[ \/]([\w.]+)/,d=/(msie) ([\w.]+)/,b=/(mozilla)(?:.*? rv:([\w.]+))?/,j=window.navigator.userAgent.toLowerCase(),i=a.exec(j)||f.exec(j)||g.exec(j)||e.exec(j)||d.exec(j)||j.indexOf("compatible")===-1&&b.exec(j)||[],h=i[1]||"",l=i[2]||"0",m=function(){var a,b,c,d;c=l.split("."),d=[];for(a=0,b=c.length;a<b;a++)k=c[a],d.push(Number(k));return d}(),c.exports=Capabilities={browser:{name:h,version:l,versions:m,is:{browser:!0}},supports:{smoothing:!(h==="msie"&&m[9]<=7),VML:h==="msie"&&m[0]<=8&&(typeof (n=document.namespace).add==="function"?n.add():void 0)!=null,touch:(typeof document.createTouch==="function"?document.createTouch():void 0)!=null,canvas:window.HTMLCanvasElement!=null}}})).call(this)},"text/TextField":function(a,b,c){((function(){var Graphics,InteractiveObject,Matrix,Rectangle,TextField,TextFormat,a=Object.prototype.hasOwnProperty,d=function(b,c){function e(){this.constructor=b}for(var d in c)a.call(c,d)&&(b[d]=c[d]);return e.prototype=c.prototype,b.prototype=new e,b.__super__=c.prototype,b};Graphics=b("display/Graphics"),InteractiveObject=b("display/InteractiveObject"),TextFormat=b("text/TextFormat"),Matrix=b("geom/Matrix"),Rectangle=b("geom/Rectangle"),c.exports=TextField=function(){function TextField(a,b){a==null&&(a=""),b==null&&(b=new TextFormat),TextField.__super__.constructor.call(this),this.defineProperty("text",function(){return this._texts.join("\n")},function(a){return this._texts=this._stacks[0].arguments[0]=a.split(/\r?\n/),this._requestRender(!0)}),this.defineProperty("textFormat",function(){return this._textFormat},function(a){return this._textFormat=this._stacks[0].arguments[1]=a,this._requestRender(!0)}),this.defineProperty("maxWidth",function(){return this._maxWidth},function(a){return this._maxWidth=this._stacks[0].arguments[2]=value,this._requestRender(!0)}),this._stacks.push({method:"drawText",arguments:[]}),this.text=a,this.textFormat=b}return d(TextField,InteractiveObject),TextField.prototype._measureSize=function(){var a,b,c,d,e,f;if(this._texts!=null&&this._textFormat!=null){b=new Rectangle,this._context.font=this._textFormat.toStyleSheet(),f=this._texts;for(d=0,e=f.length;d<e;d++)c=f[d],b.width=Math.max(b.width,this._context.measureText(c).width),b.height+=this._textFormat.size*1.2+this._textFormat.leading;this._width=b.width,this._height=b.height,this._rect=b,a=b.clone(),a.x=-a.width,a.width*=2,a.y=-a.height,a.height*=2,this._bounds=a}},TextField.prototype._drawText=function(a,b){var c,d,e,f,g;this._context.font=b.toStyleSheet(),this._context.textAlign=b.align,this._context.textBaseline=b.baseline,this._context.fillStyle=Graphics.toColorString(b.color,b.alpha),d=b.size+b.leading,g=this._texts;for(c=0,f=g.length;c<f;c++)e=g[c],this._context.fillText(e,0,d*c)},TextField}()})).call(this)},"text/TextFormat":function(a,b,c){((function(){var TextFormat,TextFormatAlign,TextFormatBaseline,TextFormatFont;TextFormatAlign=b("text/TextFormatAlign"),TextFormatBaseline=b("text/TextFormatBaseline"),TextFormatFont=b("text/TextFormatFont"),c.exports=TextFormat=function(){function TextFormat(a,b,c,d,e,f,g,h,i,j){var k;this.font=a!=null?a:TextFormatFont.SANS_SERIF,this.size=b!=null?b:16,this.color=c!=null?c:0,this.alpha=d!=null?d:1,this.bold=e!=null?e:!1,this.italic=f!=null?f:!1,this.smallCaps=g!=null?g:!1,this.align=h!=null?h:TextFormatAlign.START,this.baseline=i!=null?i:TextFormatBaseline.TOP,this.leading=j!=null?j:0,this.font instanceof TextFormat&&(k=this.font,this.font=k.font,this.size=k.size,this.color=k.color,this.alpha=k.alpha,this.bold=k.bold,this.italic=k.italic,this.smallCaps=k.smallCaps,this.align=k.align,this.baseline=k.baseline,this.leading=k.leading)}return TextFormat.prototype.toStyleSheet=function(){var a,b,c,d;c=!1;for(b in TextFormatFont){d=TextFormatFont[b];if(d!==this.font)continue;c=!0;break}return a=c?this.font:"'"+this.font+"'",""+(this.italic?"italic":"normal")+" "+(this.smallCaps?"small-caps":"normal")+" "+(this.bold?"bold":"normal")+" "+this.size+"px "+a},TextFormat}()})).call(this)},"text/TextFormatAlign":function(a,b,c){((function(){var TextFormatAlign;c.exports=TextFormatAlign={START:"start",END:"end",LEFT:"left",RIGHT:"right",CENTER:"center"}})).call(this)},"text/TextFormatBaseline":function(a,b,c){((function(){var TextFormatBaseline;c.exports=TextFormatBaseline={TOP:"top",HANGING:"hanging",MIDDLE:"middle",ALPHABETIC:"alphabetic",IDEOGRAPHIC:"ideographic",BOTTOM:"bottom"}})).call(this)},"text/TextFormatFont":function(a,b,c){((function(){var TextFormatFont;c.exports=TextFormatFont={SERIF:"serif",SANS_SERIF:"sans-serif",CURSIVE:"cursive",MONOSPACE:"monospace",FANTASY:"fantasy"}})).call(this)},"timers/Stopwatch":function(a,b,c){((function(){var Stopwatch,a,d,e;a=b("utils/ObjectUtil").clone,d=b("utils/StringUtil").padRight,e={},c.exports=Stopwatch={start:function(a){var b;a in e!=null?b=e[a]:(b=e[a]={},b.counter=0,b.total=0),b._startAt=(new Date).getTime()},stop:function(a){var b;b=e[a],(b!=null?b._startAt:void 0)!=null&&(b.counter++,b.total+=(new Date).getTime()-b._startAt,b.average=b.total/b.counter,delete b._startAt)},toObject:function(b){return a(e[b])},toString:function(a){var b,c;a==null&&(a=null);if(a!=null)return this._toString(a,0);b="name".length;for(a in e)b=Math.max(b,a.length);c=[];for(a in e)c.push(this._toString(a,b));return c.join("\n")},_toString:function(a,b){var c;return c=e[a],""+d(a,b," ")+" : "+c.total+"(ms) / "+c.counter+" = "+c.average+"(ms)"}}})).call(this)},"timers/Ticker":function(a,b,c){((function(){var Ticker,a,b,d;d=function(){return this.requestAnimationFrame||this.webkitRequestAnimationFrame||this.mozRequestAnimationFrame||this.oRequestAnimationFrame||this.msRequestAnimationFrame||function(a){return setTimeout(function(){return a((new Date).getTime())},1e3/60)}}(),a=null,b=!1,c.exports=Ticker=function(){function Ticker(){this._onAnimationFrame=__bind(this._onAnimationFrame,this);if(b===!1)throw new Error("Ticker is singleton model, call Ticker.getInstance().");b=!1,this._handlers=[],this._continuous=!1,this._counter=0}return Ticker.getInstance=function(){return a==null&&(b=!0,a=new Ticker),a},Ticker.prototype.addHandler=function(a){this._handlers.push(a),this._continuous===!1&&(this._continuous=!0,d(this._onAnimationFrame))},Ticker.prototype.removeHandler=function(a){this._handlers.splice(this._handlers.indexOf(a),1),this._handlers.length===0&&(this._continuous=!1)},Ticker.prototype._onAnimationFrame=function(a){var b,c,e,f,g;this._counter++,g=this._handlers,c=function(b){return setTimeout(function(){return b(a)},0)};for(e=0,f=g.length;e<f;e++)b=g[e],c(b);this._continuous===!0&&d(this._onAnimationFrame)},Ticker}()})).call(this)},"timers/Timer":function(a,b,c){((function(){var EventDispatcher,Timer,a,d,e=function(a,b){return function(){return a.apply(b,arguments)}},f=Object.prototype.hasOwnProperty,g=function(a,b){function d(){this.constructor=a}for(var c in b)f.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};EventDispatcher=b("events/EventDispatcher"),d=setInterval,a=clearInterval,c.exports=Timer=function(){function Timer(a,b){b==null&&(b=0),this._onInterval=e(this._onInterval,this),this.delay=Number(a);if(isNaN(this.delay))throw new Error("Timer constructor requires delay as Number.");this.reset()}return g(Timer,EventDispatcher),Timer.prototype.__defineGetter__("delay",function(){return this._delay}),Timer.prototype.__defineSetter__("delay",function(a){var b;b=this._running,this.stop(),this._delay=a;if(b)return this.start()}),Timer.prototype.__defineGetter__("repeatCount",function(){return this._repeatCount}),Timer.prototype.__defineSetter__("repeatCount",function(a){this._repeatCount=a;if(this._repeatCount!==0&&this._currentCount>=this._repeatCount)return this.stop()}),Timer.prototype.__defineGetter__("currentCount",function(){return this._currentCount}),Timer.prototype.__defineGetter__("running",function(){return this._running}),Timer.prototype.reset=function(){this.stop(),this._currentCount=0},Timer.prototype.start=function(){this._running!==!0&&(this._repeatCount===0||this._currentCount<this._repeatCount)&&(this._intervalId!=null&&a(this._intervalId),this._running=!0,this._intervalId=d(this._onInterval,this._delay))},Timer.prototype.stop=function(){this._running=!1,this._intervalId!=null&&(a(this._intervalId),this._intervalId=null)},Timer.prototype._onInterval=function(){this.dispatchEvent("timer"),this._repeatCount!==0&&++this._currentCount>=this._repeatCount&&(this.stop(),this.dispatchEvent("timerComplete"))},Timer}()})).call(this)},"tweens/Easing":function(a,b,c){((function(){var Easing,a,b,d,e,f,g,h,i,j;a=Math.PI,d=a*2,b=a/2,e=Math.abs,h=Math.pow,j=Math.sqrt,i=Math.sin,g=Math.cos,f=Math.asin,c.exports=Easing=function(){function Easing(){}return Easing.linear=function(a,b,c,d){return c*a/d+b},Easing.easeInQuad=function(a,b,c,d){return a/=d,c*a*a+b},Easing.easeOutQuad=function(a,b,c,d){return a/=d,-c*a*(a-2)+b},Easing.easeInOutQuad=function(a,b,c,d){return a*=2/d,a<1?c/2*a*a+b:(a--,-c/2*(a*(a-2)-1)+b)},Easing.easeOutInQuad=function(a,b,c,d){return a*=2/d,a<1?-c/2*a*(a-2)+b:(a--,c/2*(a*a+1)+b)},Easing.easeInCubic=function(a,b,c,d){return a/=d,c*a*a*a+b},Easing.easeOutCubic=function(a,b,c,d){return a=a/d-1,c*(a*a*a+1)+b},Easing.easeInOutCubic=function(a,b,c,d){return a*=2/d,a<1?c/2*a*a*a+b:(a-=2,c/2*(a*a*a+2)+b)},Easing.easeOutInCubic=function(a,b,c,d){return a=a*2/d-1,c/2*(a*a*a+1)+b},Easing.easeInQuart=function(a,b,c,d){return a/=d,c*a*a*a*a+b},Easing.easeOutQuart=function(a,b,c,d){return a=a/d-1,-c*(a*a*a*a-1)+b},Easing.easeInOutQuart=function(a,b,c,d){return a*=2/d,a<1?c/2*a*a*a*a+b:(a-=2,-c/2*(a*a*a*a-2)+b)},Easing.easeOutInQuart=function(a,b,c,d){return a=a*2/d-1,a<0?-c/2*(a*a*a*a-1)+b:c/2*(a*a*a*a+1)+b},Easing.easeInQuint=function(a,b,c,d){return a/=d,c*a*a*a*a*a+b},Easing.easeOutQuint=function(a,b,c,d){return a=a/d-1,c*(a*a*a*a*a+1)+b},Easing.easeInOutQuint=function(a,b,c,d){return a*=2/d,a<1?c/2*a*a*a*a*a+b:(a-=2,c/2*(a*a*a*a*a+2)+b)},Easing.easeOutInQuint=function(a,b,c,d){return a=a*2/d-1,c/2*(a*a*a*a*a+1)+b},Easing.easeInExpo=function(a,b,c,d){return c*h(2,10*(a/d-1))+b},Easing.easeOutExpo=function(a,b,c,d){return c*(1-h(2,-10*a/d))+b},Easing.easeInOutExpo=function(a,b,c,d){return a=a*2/d-1,a<0?c/2*h(2,10*a)+b:c/2*(2-h(2,-10*a))+b},Easing.easeOutInExpo=function(a,b,c,d){return a*=2/d,a===1?c/2+b:a<1?c/2*(1-h(2,-10*a))+b:c/2*(1+h(2,10*(a-2)))+b},Easing.easeInSine=function(a,c,d,e){return-d*(g(a/e*b)-1)+c},Easing.easeOutSine=function(a,c,d,e){return d*i(a/e*b)+c},Easing.easeInOutSine=function(b,c,d,e){return-d/2*(g(a*b/e)-1)+c},Easing.easeOutInSine=function(a,c,d,e){return a*=2/e,a<1?d/2*i(a*b)+c:-d/2*(g((a-1)*b)-2)+c},Easing.easeInCirc=function(a,b,c,d){return a/=d,-c*(j(1-a*a)-1)+b},Easing.easeOutCirc=function(a,b,c,d){return a=a/d-1,c*j(1-a*a)+b},Easing.easeInOutCirc=function(a,b,c,d){return a*=2/d,a<1?-c/2*(j(1-a*a)-1)+b:(a-=2,c/2*(j(1-a*a)+1)+b)},Easing.easeOutInCirc=function(a,b,c,d){return a=a*2/d-1,a<0?c/2*j(1-a*a)+b:-c/2*(j(1-a*a)-2)+b},Easing.easeInBackWith=function(a){return a==null&&(a=1.70158),function(b,c,d,e){var f;return f=a,b/=e,d*b*b*((f+1)*b-f)+c}},Easing.easeInBack=Easing.easeInBackWith(),Easing.easeOutBackWith=function(a){return a==null&&(a=1.70158),function(b,c,d,e){var f;return f=a,b=b/e-1,d*(b*b*((f+1)*b+f)+1)+c}},Easing.easeOutBack=Easing.easeOutBackWith(),Easing.easeInOutBackWith=function(a){return a==null&&(a=1.70158),function(b,c,d,e){var f;return f=a*1.525,b*=2/e,b<1?d/2*b*b*((f+1)*b-f)+c:(b-=2,d/2*(b*b*((f+1)*b+f)+2)+c)}},Easing.easeInOutBack=Easing.easeInOutBackWith(),Easing.easeOutInBackWith=function(a){return a==null&&(a=1.70158),function(b,c,d,e){var f;return f=a,b=b*2/e-1,b<0?d/2*(b*b*((f+1)*b+f)+1)+c:d/2*(b*b*((f+1)*b-f)+1)+c}},Easing.easeOutInBack=Easing.easeOutInBackWith(),Easing.easeInBounce=function(a,b,c,d){return a=1-a/d,a<.36363636363636365?-c*(7.5625*a*a-1)+b:a<.7272727272727273?(a-=.5454545454545454,-c*(7.5625*a*a-.25)+b):a<.9090909090909091?(a-=.8181818181818182,-c*(7.5625*a*a-.0625)+b):(a-=.9545454545454546,-c*(7.5625*a*a-.015625)+b)},Easing.easeOutBounce=function(a,b,c,d){return a/=d,a<.36363636363636365?c*7.5625*a*a+b:a<.7272727272727273?(a-=.5454545454545454,c*(7.5625*a*a+.75)+b):a<.9090909090909091?(a-=.8181818181818182,c*(7.5625*a*a+.9375)+b):(a-=.9545454545454546,c*(7.5625*a*a+.984375)+b)},Easing.easeInOutBounce=function(a,b,c,d){return a*=2/d,a<1?(a=1-a,a<.36363636363636365?-c/2*(7.5625*a*a-1)+b:a<.7272727272727273?(a-=.5454545454545454,-c/2*(7.5625*a*a-.25)+b):a<.9090909090909091?(a-=.8181818181818182,-c/2*(7.5625*a*a-.0625)+b):(a-=.9545454545454546,-c/2*(7.5625*a*a-.015625)+b)):(a-=1,a<.36363636363636365?c/2*(7.5625*a*a+1)+b:a<.7272727272727273?(a-=.5454545454545454,c/2*(7.5625*a*a+1.75)+b):a<.9090909090909091?(a-=.8181818181818182,c/2*(7.5625*a*a+1.9375)+b):(a-=.9545454545454546,c/2*(7.5625*a*a+1.984375)+b))},Easing.easeOutInBounce=function(a,b,c,d){return a*=2/d,a<1?a<.36363636363636365?c/2*7.5625*a*a+b:a<.7272727272727273?(a-=.5454545454545454,c/2*(7.5625*a*a+.75)+b):a<.9090909090909091?(a-=.8181818181818182,c/2*(7.5625*a*a+.9375)+b):(a-=.9545454545454546,c/2*(7.5625*a*a+.984375)+b):(a=2-a,a<.36363636363636365?-c/2*(7.5625*a*a-2)+b:a<.7272727272727273?(a-=.5454545454545454,-c/2*(7.5625*a*a-1.25)+b):a<.9090909090909091?(a-=.8181818181818182,-c/2*(7.5625*a*a-1.0625)+b):(a-=.9545454545454546,-c/2*(7.5625*a*a-1.015625)+b))},Easing.easeInElasticWith=function(a,b){return a==null&&(a=0),b==null&&(b=0),function(c,g,j,k){var l,m,n;return m=a,n=b,c=c/k-1,n===0&&(n=k*.3),m===0||m<e(j)?(m=j,l=n/4):l=n/d*f(j/m),-m*h(2,10*c)*i((c*k-l)*d/n)+g}},Easing.easeInElastic=Easing.easeInElasticWith(),Easing.easeOutElasticWith=function(a,b){return a==null&&(a=0),b==null&&(b=0),function(c,g,j,k){var l,m,n;return m=a,n=b,c/=k,n===0&&(n=k*.3),m===0||m<e(j)?(m=j,l=n/4):l=n/d*f(j/m),m*h(2,-10*c)*i((c*k-l)*d/n)+g+j}},Easing.easeOutElastic=Easing.easeOutElasticWith(),Easing.easeInOutElasticWith=function(a,b){return a==null&&(a=0),b==null&&(b=0),function(c,g,j,k){var l,m,n;return m=a,n=b,c=c*2/k-1,n===0&&(n=k*.45),m===0||m<e(j)?(m=j,l=n/4):l=n/d*f(j/m),c<0?-m/2*h(2,10*c)*i((c*k-l)*d/n)+g:m/2*h(2,-10*c)*i((c*k-l)*d/n)+g+j}},Easing.easeInOutElastic=Easing.easeInOutElasticWith(),Easing.easeOutInElasticWith=function(a,b){return a==null&&(a=0),b==null&&(b=0),function(c,g,j,k){var l,m,n;return m=a,n=b,c=c*2/k,j/=2,n===0&&(n=k*.3),m===0||m<e(j)?(m=j,l=n/4):l=n/d*f(j/m),c<1?m*h(2,-10*c)*i((c*k-l)*d/n)+g+j:(c-=2,-m*h(2,10*c)*i((c*k-l)*d/n)+g+j)}},Easing.easeOutInElastic=Easing.easeOutInElasticWith(),Easing}()})).call(this)},"tweens/Tween":function(a,b,c){((function(){var Easing,Ticker,Tween;Ticker=b("timers/Ticker"),Easing=b("tweens/Easing"),c.exports=Tween=function(){function Tween(a,b,c,d,e){this.target=a,this.src=b,this.dst=c,this.duration=d,this.easing=e,this.update=__bind(this.update,this),this._ticker=Ticker.getInstance()}return Tween.tween=function(a,b,c,d,e){return d==null&&(d=1e3),e==null&&(e=Easing.linear),new Tween(a,b,c,d,e)},Tween.to=function(a,b,c,d){return c==null&&(c=1e3),d==null&&(d=Easing.linear),new Tween(a,null,b,c,d)},Tween.prototype.play=function(){var a,b,c,d,e,f,g,h,i;g=this.target,f=this.src,c=this.dst,b={};for(e in f)b[e]==null&&(b[e]=[]),b[e][0]=f[e];for(e in c)b[e]==null&&(b[e]=[]),b[e][1]=c[e];for(e in b){a=b[e];for(d=0,i=a.length;d<i;d++)h=a[d],h==null&&(a[d]=g[e])}return this.changers=b,this._beginningTime=(new Date).getTime(),this._ticker.addHandler(this.update)},Tween.prototype.update=function(a){var b,c,d,e,f,g;this.time=a-this._beginningTime,(d=this.time>=this.duration)?(this.time=this.duration,e=1,this._ticker.removeHandler(this.update)):e=this.easing(this.time,0,1,this.duration),g=this.target,c=this.changers;for(f in c)b=c[f],g[f]=b[0]+(b[1]-b[0])*e;this.onUpdate!=null&&this.onUpdate(),d&&this.onComplete!=null&&this.onComplete(this)},Tween}()})).call(this)},"utils/ArrayUtil":function(a,b,c){((function(){var ArrayUtil,a,b,d,e=Object.prototype.hasOwnProperty,f=Array.prototype.indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(e.call(this,b)&&this[b]===a)return b;return-1};d=Array.prototype.shift,a=Math.ceil,b=Math.floor,c.exports=ArrayUtil={isArray:typeof Array.isArray=="function"?function(a){return Array.isArray(a)}:function(a){return Object.prototype.toString.call(a)==="[object Array]"},"in":function(a,b){return f.call(a,b)>=0},indexOf:typeof Array.prototype.indexOf=="function"?function(a,b,c){return Array.prototype.indexOf.apply(d.call(arguments),arguments)}:function(c,d,e){var f,g;e==null&&(e=0),g=c.length,e=e<0?a(e):b(e),e<0&&(e+=g);for(f=e;f<=g;f+=1)if(f in c&&c[f]===d)return f;return-1},lastIndexOf:typeof Array.prototype.lastIndexOf=="function"?function(a,b,c){return Array.prototype.lastIndexOf.apply(d.call(arguments),arguments)}:function(c,d,e){var f,g;e==null&&(e=Number.MAX_VALUE),g=c.length,e=e<0?a(e):b(e),e<0?e+=g:e=g-1;for(f=e;f>=-1;f+=-1)if(f in c&&c[f]===d)return f;return-1},filter:typeof Array.prototype.filter=="function"?function(a,b,c){return Array.prototype.filter.apply(d.call(arguments),arguments)}:function(a,b,c){var d,e,f,g;c==null&&(c=null);if(typeof b!="function")throw new TypeError;g=[];for(d=0,f=a.length;d<f;d++)e=a[d],d in a&&b.call(c,e,d,a)&&g.push(e);return g},forEach:typeof Array.prototype.forEach=="function"?function(a,b,c){Array.prototype.forEach.apply(d.call(arguments),arguments)}:function(a,b,c){var d,e,f;c==null&&(c=null);if(typeof b!="function")throw new TypeError;for(d=0,f=a.length;d<f;d++)e=a[d],d in a&&b.call(c,e,d,a)},every:typeof Array.prototype.every=="function"?function(a,b,c){return Array.prototype.every.apply(d.call(arguments),arguments)}:function(a,b,c){var d,e,f;c==null&&(c=null);if(typeof b!="function")throw new TypeError;for(d=0,f=a.length;d<f;d++){e=a[d];if(d in a&&!b.call(c,e,d,a))return!1}return!0},map:typeof Array.prototype.map=="function"?function(a,b,c){return Array.prototype.map.apply(d.call(arguments),arguments)}:function(a,b,c){var d,e,f,g;c==null&&(c=null);if(typeof b!="function")throw new TypeError;g=[];for(d=0,f=a.length;d<f;d++)e=a[d],d in a&&g.push(b.call(c,e,d,a));return g},some:typeof Array.prototype.some=="function"?function(a,b,c){return Array.prototype.some.apply(d.call(arguments),arguments)}:function(a,b,c){var d,e,f;c==null&&(c=null);if(typeof b!="function")throw new TypeError;for(d=0,f=a.length;d<f;d++){e=a[d];if(d(fo(a&&b.call(c,e,d,a))))return!0}return!1},reduce:typeof Array.prototype.reduce=="function"?function(a,b,c){return Array.prototype.reduce.apply(d.call(arguments),arguments)}:function(a,b,c){var d,e,f,g;c==null&&(c=null),e=a.length;if(typeof b!="function"||e===0&&c===null)throw new TypeError;d=0;if(c===null)do{if(d in a){c=a[d++];break}if(++d>e)throw new TypeError}while(!0);for(f=d,g=e-1;f>=g;f+=-1)f in a&&(c=b.call(null,c,a[f],f,a));return c},reduceRight:typeof Array.prototype.reduceRight=="function"?function(a,b,c){return Array.prototype.reduceRight.apply(d.call(arguments),arguments)}:function(a,b,c){var d,e,f;c==null&&(c=null),e=a.length;if(typeof b!="function"||e===0&&c===null)throw new TypeError;d=e-1;if(c===null)do{if(d in a){c=a[d--];break}if(--d<=e)throw new TypeError}while(!0);for(f=d;f>=0;f+=-1)f in a&&(c=b.call(null,c,a[f],f,a));return c},toArray:function(a){return Array.prototype.slice.call(a)},random:function(a,b){var c;b==null&&(b=1);if(b===1)return a[a.length*Math.random()>>0];a=Array.prototype.slice.call(a),c=[];while(b--)c.push(a.splice(a.length*Math.random()>>0,1)[0]);return c},shuffle:function(a){var b,c,d;b=a.length;while(b)c=Math.random()*b>>0,d=a[--b],a[b]=a[c],a[c]=d;return a},unique:function(a){var b;b={};for(var c=0,d;c<a.length;++c)d=a[c],d in b&&a.splice(c--,1),b[d]=!0;return a},rotate:function(a,b){b==null&&(b=1);if(b>0)while(b--)a.push(a.shift());else if(b<0){b*=-1;while(b--)a.unshift(a.pop())}return a},transpose:function(a){var b,c,d,e,f,g,h,i,j;g=[],c=-1;for(e=0,i=a.length;e<i;e++){h=a[e];if(!ArrayUtil.isArray(h))throw new TypeError("Element isn't Array.");b=h.length;if(e!==0&&b!==c)throw new Error("Element size differ ("+b+" should be "+c+")");c=b;if(e===0)while(b--)g[b]=[];for(f=0,j=h.length;f<j;f++)d=h[f],g[f].push(d)}return g}}})).call(this)},"utils/MathUtil":function(a,b,c){((function(){var MathUtil,a,b,d,e,f,g;a=Math.PI,b=Math.abs,e=Math.max,f=Math.min,g=Math.random,d=Math.acos,c.exports=MathUtil=function(){function MathUtil(){}return MathUtil.DPR=180/a,MathUtil.RPD=a/180,MathUtil.PI=a,MathUtil.PI2=a*2,MathUtil.PI_2=a/2,MathUtil._PI=1/a,MathUtil._PI2=1/MathUtil.PI2,MathUtil.degToRad=function(a){return a*this.RPD},MathUtil.wrapPi=function(a){return a+=this.PI,a-=(a*this._PI2>>0)*this.PI2,a-=this.PI,a},MathUtil.safeAcos=function(a){return a<=-1?this.PI:a>=1?0:d(a)},MathUtil.nearestIn=function(a,c){var d,e,g,h;d=[];for(g=0,h=c.length;g<h;g++)e=c[g],d.push(b(e-a));return c[d.indexOf(f.apply(null,d))]},MathUtil.randomBetween=function(a,b){return a+(b-a)*g()},MathUtil.convergeBetween=function(a,b,c){return f=f(b,c),e=e(b,c),a<f?f:a>e?e:a},MathUtil}()})).call(this)},"utils/ObjectUtil":function(a,b,c){((function(){var DateFormat,JSON,ObjectUtil;JSON=b("serialization/JSON"),DateFormat=b("serialization/DateFormat"),c.exports=ObjectUtil={clone:function(a){return JSON.parse(JSON.stringify(a),DateFormat.reviveJSON)},keys:Object.keys||function(a){var b,c,d;if((c=typeof a)!=="object"&&c!=="function")throw new TypeError(""+a+" isn't Object object");d=[];for(b in a){if(!__hasProp.call(a,b))continue;d.push(b)}return d}}})).call(this)},"utils/StringUtil":function(a,b,c){((function(){var StringUtil,a;a=Array.prototype.shift,c.exports=StringUtil={split:"a".split(/(a)/).length!==0?function(b,c,d){return String.prototype.split.apply(a.call(arguments),arguments)}:function(b,c,d){var e,f,g,h,i;c==null&&(c=null),d==null&&(d=-1);if(c instanceof RegExp){c=new RegExp(c.source,"g"),e=[],g=0;while((h=c.exec(b))!=null){e.push(b.slice(g,h.index));for(f=1,i=h.length;f<i;f+=1)e.push(h[f]);g=c.lastIndex}return e.push(g!==b.length?b.slice(g):""),d<0?e:e.slice(0,d)}return String.prototype.split.apply(a.call(arguments),arguments)},trim:typeof String.prototype.trim=="function"?function(a){return String.prototype.trim.call(a)}:function(a){return a.replace(/^\s+|\s+$/g,"")},trimLeft:typeof String.prototype.trimLeft=="function"?function(a){return String.prototype.trimLeft.call(a)}:function(a){return a.replace(/^\s+/g,"")},trimRight:typeof String.prototype.trimRight=="function"?function(a){return String.prototype.trimRight.call(a)}:function(a){return a.replace(/\s+$/g,"")},pad:function(a,b,c){c==null&&(c=" "),a=String(a);while(a.length<b)a=(b-a.length&1)===0?c+a:a+c;return a},padLeft:function(a,b,c){c==null&&(c=" "),a=String(a);while(a.length<b)a=c+a;return a},padRight:function(a,b,c){c==null&&(c=" "),a=String(a);while(a.length<b)a+=c;return a},repeat:function(a,b){var c;c="";while(b--)c+=a;return c},insert:function(a,b,c){return a.slice(0,b)+c+a.slice(b)},reverse:function(a){var b,c;b=a.length,c="";while(b--)c+=a.charAt(b);return c}}})).call(this)}})})()